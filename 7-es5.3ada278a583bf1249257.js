function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _get(e,t,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(r):a.value}})(e,t,r||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(c){a=!0,i=c}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"1MA0":function(e,t,r){"use strict";r.r(t),r.d(t,"HarwellModule",(function(){return U}));var n,a,i=r("ofXK"),s=r("tyNb"),o=r("JKqQ"),c=r("NCiM"),u=r("kCbX"),l=r("uhFJ"),h=r("7G6I"),f=function(){function e(){_classCallCheck(this,e),this.data=new Map;for(var t=0;t<=99;t++)this.data[t]=0;this.tapeNumber=1}return _createClass(e,[{key:"get",value:function(e){return this.data[e]}},{key:"add",value:function(e,t){this.data[e]=this.truncate(this.data[e]+t)}},{key:"subtract",value:function(e,t){this.data[e]=this.truncate(this.data[e]-t)}},{key:"multiply",value:function(e,t){var r=this.get(e)*this.get(t);this.data[9]=this.truncate(r),this.clear(t)}},{key:"divide",value:function(e,t){var r=this.get(9)/this.get(e),n=this.get(9)%this.get(e);this.data[t]=this.truncate(r),this.data[9]=this.truncate(n)}},{key:"clear",value:function(e){this.data[e]=0}},{key:"truncate",value:function(e){return Number(e.toFixed(7))}}]),e}(),p=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getOperation",value:function(e){return Math.floor(e)}},{key:"getAddressA",value:function(t){return Math.floor(e.getOrderCode(t)/100)%100}},{key:"getAddressB",value:function(t){return e.getOrderCode(t)%100}},{key:"getOrderCode",value:function(e){return Math.round(1e5*e)/10}}]),e}(),d=function(){function e(t,r){_classCallCheck(this,e),this.entries=t,this.blockEntryIndices=r,this.index=0;var n,a=_createForOfIteratorHelper(r);try{for(a.s();!(n=a.n()).done;){var i=_slicedToArray(n.value,2),s=i[0];if(i[1]===this.index){this.blockNumber=s;break}}}catch(o){a.e(o)}finally{a.f()}}return _createClass(e,[{key:"searchBlock",value:function(e){if(!this.blockEntryIndices.has(e))throw new Error("Block not found on tape after full loop");this.index=this.blockEntryIndices.get(e),this.blockNumber=e}},{key:"read",value:function(){var e=this.peek();return this.index++,this.index>=this.entries.length&&(this.index=0),e}},{key:"peek",value:function(){if(0===this.entries.length)throw new Error("No entry on tape to read.");return this.entries[this.index]}},{key:"peekAhead",value:function(){return this.peekAt(this.index===this.entries.length-1?0:this.index+1)}},{key:"peekAt",value:function(e){if(0===this.entries.length)throw new Error("No entry on tape to read.");return this.entries[e]}}]),e}(),b=function(){function e(){_classCallCheck(this,e),this.tapes=new Map,this.state=new f,this.output=[""]}return _createClass(e,[{key:"setProgram",value:function(e){this.tapes=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"assemble",value:function(e){var t=new Map,r=1,n=[],a=new Map;return e.split("\n").forEach((function(e){if(e.startsWith(";"));else if(e.startsWith("#")){var i=Number(e.substr(1));a.set(i,n.length)}else if(e.startsWith("[")&&e.endsWith("]")){var s=Number(e.substr(1,e.length-2));a.set(s,n.length)}else if("==tape"==e)0!==n.length&&(t[r]=new d(n,a),r++,n=[],a=new Map);else if(5===e.length){var o=Number(e)/1e4;n.push(o)}else if(9===e.length){var c=Number(e)/1e7;n.push(c)}})),t[r]=new d(n,a),t}}]),e}().assemble(e)}},{key:"readNextEntry",value:function(){if(this.state.tapeNumber>7){var e=this.state.get(this.state.tapeNumber);return this.state.tapeNumber++,e}return this.currentTape.read()}},{key:"step",value:function(){if(!this.state.finished){var e=this.readNextEntry(),t=p.getOperation(e),r=p.getAddressA(e),n=p.getAddressB(e);switch(t){case 0:this.control(r,n);break;case 1:this.add(r,n);break;case 2:this.addAndClear(r,n);break;case 3:this.subtract(r,n);break;case 4:this.subtractAndClear(r,n);break;case 5:this.multiply(r,n);break;case 6:this.divide(r,n);break;default:throw new Error("Unknown instruction "+e)}}}},{key:"control",value:function(e,t){if(e>=30&&e<=39)this.searchBlock(e%10,t);else{if(!(e>=50&&e<=59)){switch(e){case 1:0===t&&this.finish();case 11:return void this.testPositive(t);case 12:return void this.testNegative(t);case 21:return void this.transferControl(t);case 22:return void(this.state.yes&&this.transferControl(t));case 73:return void this.printLayoutReference1();case 74:return void this.printLayoutReference2()}throw new Error("Unknown control instruction 0"+e+t)}this.state.yes&&this.searchBlock(e%10,t)}}},{key:"add",value:function(e,t){var r=this.read(e);1!==t?this.state.add(t,r):this.print(r)}},{key:"addAndClear",value:function(e,t){this.add(e,t),this.state.clear(e)}},{key:"subtract",value:function(e,t){var r=this.read(e);1!==t?this.state.subtract(t,r):this.print(r)}},{key:"subtractAndClear",value:function(e,t){this.subtract(e,t),this.state.clear(e)}},{key:"multiply",value:function(e,t){this.state.multiply(e,t)}},{key:"divide",value:function(e,t){this.state.divide(e,t)}},{key:"testPositive",value:function(e){this.state.yes=this.read(e)>0}},{key:"testNegative",value:function(e){this.state.yes=this.read(e)<0}},{key:"searchBlock",value:function(e,t){this.tapes[t].searchBlock(e)}},{key:"transferControl",value:function(e){this.state.tapeNumber=e}},{key:"finish",value:function(){this.state.finished=!0}},{key:"printLayoutReference1",value:function(){this.state.printLayout=1}},{key:"printLayoutReference2",value:function(){this.state.printLayout=2}},{key:"print",value:function(e){var t=(e<0?"":"+")+e.toFixed(7);1===this.state.printLayout?this.output[this.output.length-1]+=t+"   ":2===this.state.printLayout&&(this.output[this.output.length-1]+=t,this.output.push(""))}},{key:"peek",value:function(e){return e>0&&e<8?this.tapes[e].peekData():this.state.get(e)}},{key:"peekAhead",value:function(e){return e>0&&e<8?this.tapes[e].peekAhead():this.peek(e)}},{key:"read",value:function(e){return e>0&&e<8?this.tapes[e].read():this.state.get(e)}},{key:"currentTape",get:function(){return this.state.tapeNumber>7?null:this.tapes[this.state.tapeNumber]}},{key:"currentBlockNumber",get:function(){return null!=this.currentTape?this.currentTape.blockNumber:null}}]),e}(),g=r("FCAv"),y=r("+pcE"),v=((n=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this,n)).renderingContext=n,a.meshes=[e],a.color=r.passiveColor,a.program=n.emitterShader,a.position=l.a.zero,a}return _createClass(r,[{key:"digit",get:function(){return this.currentDigit},set:function(e){if(this.currentDigit!==e){this.currentDigit=e;var t=e*(2*Math.PI/10);this.worldTransform=g.a.rotationX(Math.PI/2).multiply(g.a.translation(new l.a(0,.0095,0))).multiply(g.a.rotationZ(t)).multiply(g.a.translation(this.position))}}}]),r}(y.a)).activeColor=[1,.2,.2,1],n.passiveColor=[.6,.12,.12,1],n),m=function(){function e(t){_classCallCheck(this,e),this.isActive=!1,this.indicators=t,this.hasSignDigit=9===t.length}return _createClass(e,[{key:"getSignDigit",value:function(){return this.currentValue>=0?0:1}},{key:"getDigit",value:function(e){return Math.floor(Math.abs(this.currentValue)*Math.pow(10,e))%10}},{key:"setActive",value:function(e){if(this.isActive!==e){this.isActive=e;var t,r=_createForOfIteratorHelper(this.indicators);try{for(r.s();!(t=r.n()).done;){t.value.color=e?v.activeColor:v.passiveColor}}catch(n){r.e(n)}finally{r.f()}}}},{key:"value",set:function(e){if(this.currentValue!==e)if(null==e?(this.setActive(!1),e=0):this.setActive(!0),this.currentValue=e,this.hasSignDigit){this.indicators[0].digit=this.getSignDigit();for(var t=0;t<8;t++)this.indicators[t+1].digit=this.getDigit(t)}else for(var r=0;r<8;r++)this.indicators[r].digit=this.getDigit(r)}}]),e}(),k=((a=function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,null,[{key:"createTube",value:function(e,t){for(var r=2*Math.PI/10,n=[],a=0,i=0;i<10;i++){var s=new l.a(e*Math.cos(a),0,e*Math.sin(a)),o=new l.a(e*Math.cos(a),-t,e*Math.sin(a)),c=new l.a(0,-t,0),u=l.a.zero;a+=r;var h=new l.a(e*Math.cos(a),0,e*Math.sin(a)),f=new l.a(e*Math.cos(a),-t,e*Math.sin(a));this.pushTriangle(n,s,u,h),this.pushTriangle(n,c,o,f),this.pushTriangle(n,s,h,o),this.pushTriangle(n,o,h,f)}return n}},{key:"createTubeRow",value:function(e){for(var t=[],r=this.createTube(this.tubeRadius,this.tubeHeight),n=new l.a(-.23,0,e),a=0;a<5;a++)this.appendWithOffset(t,r,n),n.x+=this.tubeDistance;n.x+=this.memoryRegisterMiddleGap;for(var i=0;i<4;i++)this.appendWithOffset(t,r,n),n.x+=this.tubeDistance;return t}},{key:"createAccumulatorTubeRow",value:function(){for(var e=[],t=this.createTube(this.tubeRadius,this.tubeHeight),r=new l.a(-.15,0,.1),n=0;n<8;n++)this.appendWithOffset(e,t,r),r.x+=this.tubeDistance;return e}},{key:"createMemoryUnit",value:function(){for(var e=[],t=0;t<5;t++){var r=this.createTubeRow(t*this.tubeDistance-.22);this.append(e,r)}for(var n=5;n<10;n++){var a=this.createTubeRow(n*this.tubeDistance-.165);this.append(e,a)}return e}},{key:"createAccumulator",value:function(){return this.createAccumulatorTubeRow()}}]),r}(u.a)).tubeDistance=.0425,a.tubeRadius=.015,a.tubeHeight=.05,a.memoryRegisterMiddleGap=.1,a),w=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,i,s){var o;_classCallCheck(this,r),(o=t.call(this,s)).position=i;var h=y.a.withMesh(e,s);h.color=[.5,.5,.5,1],h.worldTransform=g.a.rotationX(Math.PI/2).multiply(g.a.translation(i));var f=y.a.withMesh(new c.a(u.a.createBox(new l.a(.25,.25,.1)),o.gl),s);f.color=[.5,.5,.5,1],f.worldTransform=g.a.translation(i.add(new l.a(0,0,-.15)));var p=y.a.withMesh(n,s);return p.color=[.2,.2,.2,1],p.worldTransform=g.a.rotationX(Math.PI/2).multiply(g.a.translation(i)),o.children=[h,f,p],o.createRegisters(a,s),o}return _createClass(r,[{key:"createRegisters",value:function(e,t){this.registers=[];for(var r=this.position.add(new l.a(-.23,.22,0)),n=0;n<5;n++){var a=this.createIndicators(e,t),i=new m(a);this.setIndicatorPositions(i,r),this.registers[n]=i,r=r.add(new l.a(0,-k.tubeDistance,0))}r=r.add(new l.a(0,-.055,0));for(var s=5;s<10;s++){var o=this.createIndicators(e,t),c=new m(o);this.setIndicatorPositions(c,r),this.registers[s]=c,r=r.add(new l.a(0,-k.tubeDistance,0))}}},{key:"createIndicators",value:function(e,t){for(var r=[],n=0;n<9;n++)r[n]=new v(e,t);return r}},{key:"setIndicatorPositions",value:function(e,t){for(var r=t.copy(),n=0;n<5;n++)e.indicators[n].position=r.copy(),r.x+=k.tubeDistance;r.x+=k.memoryRegisterMiddleGap;for(var a=5;a<9;a++)e.indicators[a].position=r.copy(),r.x+=k.tubeDistance}},{key:"draw",value:function(){this.children.forEach((function(e){e.draw()})),this.renderingContext.emitterShader.use(),this.registers.forEach((function(e){var t,r=_createForOfIteratorHelper(e.indicators);try{for(r.s();!(t=r.n()).done;){t.value.draw()}}catch(n){r.e(n)}finally{r.f()}})),this.renderingContext.standardShader.use()}}]),r}(y.a),C=function(){function e(t){_classCallCheck(this,e),this.processor=t}return _createClass(e,[{key:"disassemble",value:function(e){return String(Math.round(1e4*e)).padStart(5,"0")+" "+this.disassembleInstruction(e)}},{key:"disassembleInstruction",value:function(e){switch(p.getOperation(e)){case 0:return this.disassembleControl(e);case 1:return this.disassembleAdd(e);case 2:return this.disassembleAddAndClear(e);case 3:return this.disassembleSubtract(e);case 4:return this.disassembleSubtractAndClear(e);case 5:return this.disassembleMultiply(e);case 6:return this.disassembleDivide(e);default:throw new Error("Unknown operation "+e)}}},{key:"disassembleControl",value:function(e){var t=p.getAddressA(e),r=p.getAddressB(e);if(t>=30&&t<=39)return"SEARCH for block "+t%10+" on tape "+r;if(t>=50&&t<=59)return"CONDITIONAL SEARCH for block "+t%10+" on tape "+r+" ("+(this.processor.state.yes?"YES":"NO")+")";switch(t){case 1:if(0===r)return"FINISH";case 11:return"TEST POSITIVE ["+r+"] ("+this.processor.peek(r)+")";case 12:return"TEST NEGATIVE ["+r+"] ("+this.processor.peek(r)+")";case 21:return"TRANSFER to "+r;case 22:return"CONDITIONAL TRANSFER to "+r+" ("+(this.processor.state.yes?"YES":"NO")+")";case 73:return"PRINT LAYOUT REFERENCE 1";case 74:return"PRINT LAYOUT REFERENCE 2";default:throw new Error("Unknown control instruction "+e)}}},{key:"disassembleAdd",value:function(e){var t=p.getAddressA(e),r=p.getAddressB(e),n=this.processor.peekAhead(t);if(1===r)return"PRINT ["+t+"] ("+n+")";var a=this.processor.peek(r);return"["+r+"] += ["+t+"] ("+this.format(a)+" + "+this.format(n)+" = "+this.format(a+n)+")"}},{key:"disassembleAddAndClear",value:function(e){var t=p.getAddressA(e),r=p.getAddressB(e),n=this.processor.peekAhead(t);if(0===r)return"CLEAR ["+t+"] ("+n+")";if(1===r)return"PRINT ["+t+"] ("+n+")";var a=this.processor.peek(r);return"["+r+"] += ["+t+"]; CLEAR ["+t+"] ("+this.format(a)+" + "+this.format(n)+" = "+this.format(a+n)+")"}},{key:"disassembleSubtract",value:function(e){var t=p.getAddressA(e),r=p.getAddressB(e),n=this.processor.peekAhead(t);if(0===r)return"CLEAR ["+t+"] ("+n+")";if(1===r)return"PRINT ["+t+"] ("+n+")";var a=this.processor.peek(r);return"["+r+"] -= ["+t+"]; CLEAR ["+t+"] ("+this.format(a)+" - "+this.format(n)+" = "+this.format(a-n)+")"}},{key:"disassembleSubtractAndClear",value:function(e){var t=p.getAddressA(e),r=p.getAddressB(e),n=this.processor.peekAhead(t),a=this.processor.peek(r);return"["+r+"] -= ["+t+"] ("+this.format(a)+" - "+this.format(n)+" = "+this.format(a-n)+")"}},{key:"disassembleMultiply",value:function(e){var t=p.getAddressA(e),r=p.getAddressB(e),n=this.processor.peek(t),a=this.processor.peek(r);return"[09] = ["+t+"] * ["+r+"] ("+this.format(a)+" * "+this.format(a)+" = "+this.format(n*a)+")"}},{key:"disassembleDivide",value:function(e){var t=p.getAddressA(e),r=p.getAddressB(e),n=this.processor.peek(9),a=this.processor.peek(t),i=this.format(n),s=this.format(a);return"["+r+"] = [09] / ["+t+"] ("+i+" / "+s+" = "+this.format(n/a)+"); [09] = [09] % ["+t+"] ("+i+" % "+s+" = "+this.format(n%a)+")"}},{key:"format",value:function(e){return Number(e.toFixed(7)).toString()}}]),e}(),_=function e(t,r,n){_classCallCheck(this,e),this.id=t,this.title=r,this.text=n},A=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"programList",get:function(){return[new _("1","Example program 1","\n[1]\n20900\n21000\n22000\n23000\n24000\n25000\n10110\n+10000000\n10120\n+01000000\n10130\n+15500000\n03202\n02102\n\n==tape\n[2]\n11040\n51040\n07300\n11001\n07400\n10901\n12010\n13040\n31040\n01140\n24000\n20900\n05202\n05202\n00100"),new _("2","Example program 2","\n[1]\n20900\n21000\n22000\n23000\n24000\n25000\n10110\n+05000000\n10120\n+90000000\n10130\n+10000000\n10140\n+20000000\n11050\n03202\n02102\n\n==tape\n[2]\n07400\n11001\n33020\n01220\n05303\n02203\n25009\n64050\n20900\n15010\n03202\n\n==tape\n[3]\n00100"),new _("3","Pascal's triangle","\n; Exercise 5\n; Non-pairs of digits 1-4\n\n; Constants/Variables\n;\n; 10 = N1\n; 11 = N2\n; 40 = temp\n; 50 = temp\n\n==tape\n\n#1\n\n; Clear stores\n20900\n21000\n21100\n24000\n\n; Add in data\n10110\n+10000000\n10111\n+10000000\n\n; Transfer to other tape\n03202\n02102\n\n\n==tape\n\n#2\n\n; Reset N2\n21100\n10211\n+10000000\n\n#3\n\n; Subtract the values\n24000\n11040\n31140\n\n; abs(x)-0 is negative if x==0\n25000\n74050\n30250\n+00000000\n01250\n05402\n\n; Print\n07300\n11001\n07400\n11101\n\n#4\n\n; Increase N2\n24000\n10240\n+10000000\n24011\n\n; Test N2\n10240\n+50000000\n31140\n01140\n\n; Conditional search for block 3 again\n05302\n\n; Increase N1\n24000\n10240\n+10000000\n24010\n\n; Test N1\n10240\n+50000000\n31040\n01140\n\n; Conditional search for block 2 again\n05202\n\n; Stop\n00100\n\n")]}}]),e}(),I=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,i,s){var o;_classCallCheck(this,r),(o=t.call(this,s)).position=i;var h=y.a.withMesh(e,s);h.color=[.5,.5,.5,1],h.worldTransform=g.a.rotationX(Math.PI/2).multiply(g.a.translation(i));var f=y.a.withMesh(new c.a(u.a.createBox(new l.a(.25,.25,.1)),o.gl),s);f.color=[.5,.5,.5,1],f.worldTransform=g.a.translation(i.add(new l.a(0,0,-.15)));var p=y.a.withMesh(n,s);return p.color=[.2,.2,.2,1],p.worldTransform=g.a.rotationX(Math.PI/2).multiply(g.a.translation(i)),o.children=[h,f,p],o.createRegister(a,s),o}return _createClass(r,[{key:"createRegister",value:function(e,t){var r=this.position.add(new l.a(-.15,-.1,0)),n=this.createIndicators(e,t);this.register=new m(n),this.setIndicatorPositions(r)}},{key:"createIndicators",value:function(e,t){for(var r=[],n=0;n<8;n++)r[n]=new v(e,t);return r}},{key:"setIndicatorPositions",value:function(e){for(var t=e.copy(),r=0;r<8;r++)this.register.indicators[r].position=t.copy(),t.x+=k.tubeDistance}},{key:"draw",value:function(){this.children.forEach((function(e){e.draw()})),this.renderingContext.emitterShader.use();var e,t=_createForOfIteratorHelper(this.register.indicators);try{for(t.s();!(e=t.n()).done;){e.value.draw()}}catch(r){t.e(r)}finally{t.f()}this.renderingContext.standardShader.use()}}]),r}(y.a),P=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var n;_classCallCheck(this,r),(n=t.call(this,e)).isSingleStepping=!0,n.isSingleStepDone=!0,n.programList=A.programList,n.processor=new b,n.disassembler=new C(n.processor);var a=new c.a(u.a.createCase(new l.a(.25,.05,.25)),e.gl),i=new c.a(k.createMemoryUnit(),e.gl),s=new c.a(u.a.createBox(new l.a(.0025,.003,.0036)),e.gl),o=new c.a(k.createAccumulator(),e.gl),h=n.createMemoryUnitNode(a,i,s,new l.a(-.5,-.5,0)),f=n.createMemoryUnitNode(a,i,s,new l.a(-.5,0,0)),p=n.createMemoryUnitNode(a,i,s,new l.a(-.5,.5,0)),d=n.createMemoryUnitNode(a,i,s,new l.a(-.5,1,0)),g=n.createMemoryUnitNode(a,i,s,new l.a(-1,-.5,0)),y=n.createMemoryUnitNode(a,i,s,new l.a(-1,0,0)),v=n.createMemoryUnitNode(a,i,s,new l.a(-1,.5,0)),m=n.createMemoryUnitNode(a,i,s,new l.a(-1,1,0)),w=n.createMemoryUnitNode(a,i,s,new l.a(-1.5,1,0));return n.accumulator8=n.createAccumulatorNode(a,o,s,new l.a(0,-.35,0)),n.accumulator9=n.createAccumulatorNode(a,o,s,new l.a(0,.5,0)),n.memoryBanks=[h,f,p,d,g,y,v,m,w],n.nodes=[].concat(_toConsumableArray(n.memoryBanks),[n.accumulator8,n.accumulator9]),n.light.position=new l.a(.5,2,.5),n.camera.eye=new l.a(0,.5,3.3),n.camera.target=new l.a(0,.25,0),n.clearColor=[.1,.1,.1,1],n.camera.orthoScaling=2.7,n.loadFirstProgram(),n}return _createClass(r,[{key:"createMemoryUnitNode",value:function(e,t,r,n){return new w(e,t,r,n,this.renderingContext)}},{key:"createAccumulatorNode",value:function(e,t,r,n){return new I(e,t,r,n,this.renderingContext)}},{key:"onProgramChange",value:function(e){var t=this.programList.find((function(t){return t.id===e}));this.processor.setProgram(t.text),this.resetProgram()}},{key:"loadFirstProgram",value:function(){this.onProgramChange(this.programList[0].id)}},{key:"resetProgram",value:function(){this.processor.output=[""],this.isSingleStepping=!0,this.isSingleStepDone=!0,this.processor.state.finished=!1,this.processor.state.tapeNumber=1,this.setIndicatorsPassive(),this.disassembleNextInstruction()}},{key:"draw",value:function(e){_get(_getPrototypeOf(r.prototype),"draw",this).call(this,e),this.runProcessorForFrame(),this.copyStateToRenderObject(),this.renderingContext.standardShader.use(),this.nodes.forEach((function(e){e.draw()}))}},{key:"stepProcessor",value:function(){this.isSingleStepping=!0,this.isSingleStepDone=!1}},{key:"runProcessor",value:function(){this.isSingleStepping=!this.isSingleStepping}},{key:"runProcessorForFrame",value:function(){this.isSingleStepping?this.isSingleStepDone||(this.processor.step(),this.disassembleNextInstruction(),this.isSingleStepDone=!0):(this.processor.step(),this.disassembleNextInstruction()),this.processor.state.finished&&(this.isSingleStepping=!0)}},{key:"copyStateToRenderObject",value:function(){this.accumulator8.register.value=this.processor.peek(8),this.accumulator9.register.value=this.processor.peek(9);for(var e=0;e<9;e++)for(var t=this.memoryBanks[e],r=0;r<10;r++)t.registers[r].value=this.processor.peek(10*(e+1)+r)}},{key:"setIndicatorsPassive",value:function(){for(var e=0;e<9;e++)for(var t=this.memoryBanks[e],r=0;r<10;r++){var n=t.registers[r];0!==n.value&&void 0!==n.value||(n.value=null)}}},{key:"disassembleNextInstruction",value:function(){var e;e=this.processor.state.tapeNumber>7?this.processor.state.get(this.processor.state.tapeNumber):this.processor.currentTape.peek(),this.nextInstructionText=this.processor.state.finished?"(finished)":this.disassembler.disassemble(e),console.log(this.nextInstructionText)}}]),r}(h.a),S=r("4u2P"),O=r("fXoL"),N=r("jhN1"),T=r("S8xs");function M(e,t){if(1&e&&(O.Jb(0,"option",17),O.bc(1),O.Ib()),2&e){var r=t.$implicit;O.Ub("value",r.id),O.wb(1),O.cc(r.title)}}function x(e,t){if(1&e&&(O.Jb(0,"p",13),O.bc(1),O.Ib()),2&e){var r=t.$implicit;O.wb(1),O.cc(r)}}var R,E,D,J=[{path:"",component:(R=function(){function e(t){_classCallCheck(this,e),this.isOrtographicProjection=!1,t.setTitle("Harwell Dekatron")}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this.appCanvas.surface.nativeElement.getContext("webgl");if(e){var t=new S.a(e);this.scene=new P(t),this.appCanvas.setScene(this.scene)}}},{key:"onChangeOrtographicProjection",value:function(){this.isOrtographicProjection=!this.isOrtographicProjection,this.scene.camera.orthographic=this.isOrtographicProjection}}]),e}(),R.\u0275fac=function(e){return new(e||R)(O.Gb(N.b))},R.\u0275cmp=O.Ab({type:R,selectors:[["harwell-component"]],viewQuery:function(e,t){var r;1&e&&O.Zb(o.a,!0),2&e&&O.Wb(r=O.Qb())&&(t.appCanvas=r.first)},decls:40,vars:12,consts:[["id","bodyContainer"],["id","leftPanel"],[3,"isAnimated"],[3,"isOpen"],["accordion-heading","","type","button",1,"btn","btn-link","btn-block","clearfix"],[1,"badge","badge-arrow","float-left"],[1,"float-left"],[1,"mb-3",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"btn-toolbar","mb-3"],["type","button",1,"btn","btn-primary","mr-2",3,"disabled","click"],["type","button",1,"btn","btn-primary","mr-4",3,"disabled","click"],["type","button",1,"btn","btn-primary","mr-2",3,"click"],[1,"mb-0"],[2,"min-height","5em"],["class","mb-0",4,"ngFor","ngForOf"],["value","ds","type","checkbox",3,"checked","change"],[3,"value"]],template:function(e,t){1&e&&(O.Jb(0,"div",0),O.Jb(1,"div",1),O.Jb(2,"accordion",2),O.Jb(3,"accordion-group",3),O.Jb(4,"button",4),O.Jb(5,"span",5),O.bc(6,"\u2b9e"),O.Ib(),O.Jb(7,"span",6),O.bc(8,"Control"),O.Ib(),O.Ib(),O.Jb(9,"select",7),O.Pb("change",(function(e){return t.scene.onProgramChange(e.target.value)})),O.ac(10,M,2,2,"option",8),O.Ib(),O.Jb(11,"div",9),O.Jb(12,"button",10),O.Pb("click",(function(){return t.scene.stepProcessor()})),O.bc(13,"Step"),O.Ib(),O.Jb(14,"button",11),O.Pb("click",(function(){return t.scene.runProcessor()})),O.bc(15),O.Ib(),O.Jb(16,"button",12),O.Pb("click",(function(){return t.scene.resetProgram()})),O.bc(17,"Reload "),O.Ib(),O.Hb(18,"br"),O.Ib(),O.Jb(19,"p",13),O.bc(20),O.Ib(),O.Jb(21,"p",14),O.bc(22),O.Ib(),O.Ib(),O.Jb(23,"accordion-group",3),O.Jb(24,"button",4),O.Jb(25,"span",5),O.bc(26,"\u2b9e"),O.Ib(),O.Jb(27,"span",6),O.bc(28,"Output"),O.Ib(),O.Ib(),O.ac(29,x,2,1,"p",15),O.Ib(),O.Jb(30,"accordion-group"),O.Jb(31,"button",4),O.Jb(32,"span",5),O.bc(33,"\u2b9e"),O.Ib(),O.Jb(34,"span",6),O.bc(35,"Settings"),O.Ib(),O.Ib(),O.Jb(36,"label"),O.Jb(37,"input",16),O.Pb("change",(function(){return t.onChangeOrtographicProjection()})),O.Ib(),O.bc(38," Orthographic projection "),O.Ib(),O.Ib(),O.Ib(),O.Ib(),O.Hb(39,"app-canvas"),O.Ib()),2&e&&(O.wb(2),O.Ub("isAnimated",!0),O.wb(1),O.Ub("isOpen",!0),O.wb(7),O.Ub("ngForOf",t.scene.programList),O.wb(2),O.Ub("disabled",t.scene.processor.state.finished),O.wb(2),O.Ub("disabled",t.scene.processor.state.finished),O.wb(1),O.dc(" ",t.scene.isSingleStepping?"Run":"Stop"," "),O.wb(5),O.ec("Tape ",t.scene.processor.state.tapeNumber,", block ",t.scene.processor.currentBlockNumber,""),O.wb(2),O.dc("Order: ",t.scene.nextInstructionText,""),O.wb(1),O.Ub("isOpen",!0),O.wb(6),O.Ub("ngForOf",t.scene.processor.output),O.wb(8),O.Ub("checked",t.isOrtographicProjection))},directives:[T.a,T.c,i.i,o.a],styles:["#leftPanel[_ngcontent-%COMP%]{width:350px;height:768px;float:left;overflow-y:auto;white-space:normal}#bodyContainer[_ngcontent-%COMP%]{white-space:nowrap}.badge-arrow[_ngcontent-%COMP%]{margin-top:4px;transition-duration:.2s;transition-property:transform}.panel-open[_ngcontent-%COMP%]   .badge-arrow[_ngcontent-%COMP%]{transform:rotate(90deg)}ul[_ngcontent-%COMP%]{padding-left:25px}.gear-group-a[_ngcontent-%COMP%]{background-color:#99801a}.gear-group-l[_ngcontent-%COMP%]{background-color:#e6801a}.gear-group-n[_ngcontent-%COMP%]{background-color:#40bf4d}.gear-group-o[_ngcontent-%COMP%]{background-color:#fff}.gear-group-p[_ngcontent-%COMP%]{background-color:#80bf33}.gear-group-e[_ngcontent-%COMP%]{background-color:#7366b3}.gear-group-h[_ngcontent-%COMP%]{background-color:#a666b3}.gear-group-c[_ngcontent-%COMP%]{background-color:#80bfe6}.gear-group-k[_ngcontent-%COMP%]{background-color:#73ccbf}"]}),R)}],j=((E=function e(){_classCallCheck(this,e)}).\u0275mod=O.Eb({type:E}),E.\u0275inj=O.Db({factory:function(e){return new(e||E)},imports:[[s.a.forChild(J)],s.a]}),E),L=r("YP2Z"),U=((D=function e(){_classCallCheck(this,e)}).\u0275mod=O.Eb({type:D}),D.\u0275inj=O.Db({factory:function(e){return new(e||D)},imports:[[i.b,j,L.a,T.b.forRoot()]]}),D)}}]);