function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(n):a.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"1MA0":function(e,t,n){"use strict";n.r(t),n.d(t,"HarwellModule",(function(){return S}));var r,a,o,i,s=n("ofXK"),c=n("tyNb"),u=n("JKqQ"),l=n("NCiM"),h=n("kCbX"),f=n("uhFJ"),d=n("7G6I"),p=function(){function e(){_classCallCheck(this,e),this.data={};for(var t=1;t<=99;t++)this.data[String(t).padStart(2,"0")]=0;this.tapeNumber=1}return _createClass(e,[{key:"get",value:function(e){return this.data[e]}},{key:"add",value:function(e,t){this.data[e]=Number((this.data[e]+t).toFixed(7))}},{key:"subtract",value:function(e,t){this.data[e]=Number((this.data[e]-t).toFixed(7))}},{key:"multiply",value:function(e,t){var n=this.get(e)*this.get(t);this.data["09"]=Number(n.toFixed(7)),this.clear(t)}},{key:"divide",value:function(e,t){var n=this.get("09")/this.get(e),r=this.get("09")%this.get(e);this.data[t]=Number(n.toFixed(7)),this.data["09"]=Number(r.toFixed(7))}},{key:"clear",value:function(e){this.data[e]=0}}]),e}(),g=function(){function e(t){_classCallCheck(this,e),this.code=t}return _createClass(e,[{key:"operation",get:function(){return this.code[0]}},{key:"addressA",get:function(){return this.code.substr(1,2)}},{key:"addressB",get:function(){return this.code.substr(3,2)}}],[{key:"fromCode",value:function(t){return new e(t)}}]),e}(),v=function(){function e(t){_classCallCheck(this,e),this.value=t}return _createClass(e,[{key:"valueOf",value:function(){return this.value}}]),e}(),y=function e(t){_classCallCheck(this,e),this.blockNumber=t},b=function(){function e(t){_classCallCheck(this,e),this.entries=t,this.index=0}return _createClass(e,[{key:"searchBlock",value:function(e){for(var t=this.index;;){var n=this.readEntry();if(n instanceof y&&n.blockNumber===e)return;if(this.index===t)throw new Error("Block not found on tape after full loop")}}},{key:"readInstruction",value:function(){return this.readEntry()}},{key:"readData",value:function(){return this.readEntry()}},{key:"peekData",value:function(){return this.peekEntry()}},{key:"readEntry",value:function(){var e=this.peekEntry();return this.index++,this.index>=this.entries.length&&(this.index=0),e}},{key:"peekEntry",value:function(){if(0===this.entries.length)throw new Error("No entry on tape to read.");return this.entries[this.index]}}],[{key:"parse",value:function(t){var n=[];return t.split("\n").forEach((function(e){if(5===e.length)n.push(g.fromCode(e));else if(9===e.length){var t=Number(e)/1e7;n.push(new v(t))}else if(3===e.length){var r=Number(e.substr(1,1));n.push(new y(r))}})),new e(n)}}]),e}(),k=function(){function e(){_classCallCheck(this,e),this.tapes=new Map,this.state=new p,this.output=""}return _createClass(e,[{key:"setTape",value:function(e,t){this.tapes[e]=b.parse(t)}},{key:"step",value:function(){if(!this.state.finished){var e=this.currentTape.readEntry();if(!(e instanceof y)){var t=e;switch(t.operation){case"0":this.control(t.addressA,t.addressB);break;case"1":this.add(t.addressA,t.addressB);break;case"2":this.addAndClear(t.addressA,t.addressB);break;case"3":this.subtract(t.addressA,t.addressB);break;case"4":this.subtractAndClear(t.addressA,t.addressB);break;case"5":this.multiply(t.addressA,t.addressB);break;case"6":this.divide(t.addressA,t.addressB);break;default:throw new Error("Unknown instruction "+t.code)}}}}},{key:"control",value:function(e,t){if("3"!==e[0]){if("5"!==e[0]){switch(e){case"01":return void("00"===t&&this.finish());case"11":return void this.testPositive(t);case"12":return void this.testNegative(t);case"21":return void this.transferControl(t);case"22":return void(this.state.yes&&this.transferControl(t));case"73":return void this.printLayoutReference1();case"74":return void this.printLayoutReference2()}throw new Error("Unknown control instruction 0"+e+t)}if(this.state.yes){var n=Number(e[1]),r=Number(t);this.searchBlock(n,r)}else console.log("NO TRANSFER")}else{var a=Number(e[1]),o=Number(t);this.searchBlock(a,o)}}},{key:"add",value:function(e,t){if("01"!==t){var n=this.peek(t),r=this.load(e);console.log("["+t+"] += ["+e+"] ("+n+" + "+r+" = "+(n+r).toFixed(7)+")"),this.state.add(t,r)}else this.print(e)}},{key:"addAndClear",value:function(e,t){"00"===t?console.log("Clear "+e):this.add(e,t),this.state.clear(e)}},{key:"subtract",value:function(e,t){if("01"!==t){var n=this.peek(t),r=this.load(e);console.log("["+t+"] -= ["+e+"] ("+n+" - "+r+" = "+(n-r).toFixed(7)+")"),this.state.subtract(t,r)}else this.print(e)}},{key:"subtractAndClear",value:function(e,t){"00"===t?console.log("Clear "+e):this.subtract(e,t),this.state.clear(e)}},{key:"multiply",value:function(e,t){var n=this.peek(e),r=this.peek(e);console.log("[09] = ["+e+"] * ["+t+"] ("+n+" * "+r+" = "+(n*r).toFixed(7)+")"),this.state.multiply(e,t)}},{key:"divide",value:function(e,t){var n=this.peek("09"),r=this.peek(e);console.log("["+t+"] = [09] / ["+e+"] ("+n+" / "+r+" = "+(n/r).toFixed(7)+")"),console.log("[09] = [09] % ["+e+"] ("+n+" % "+r+" = "+(n%r).toFixed(7)+")"),this.state.divide(e,t)}},{key:"testPositive",value:function(e){console.log("TEST POSITIVE ["+e+"] ("+this.peek(e)+")"),this.state.yes=this.load(e)>0}},{key:"testNegative",value:function(e){console.log("TEST NEGATIVE ["+e+"] ("+this.peek(e)+")"),this.state.yes=this.load(e)<0}},{key:"searchBlock",value:function(e,t){console.log("SEARCH for block "+e+" on tape "+t),this.tapes[t].searchBlock(e)}},{key:"transferControl",value:function(e){console.log("TRANFER to "+e),this.state.tapeNumber=Number(e)}},{key:"finish",value:function(){console.log("FINISH"),this.state.finished=!0,console.log(this.output)}},{key:"printLayoutReference1",value:function(){console.log("PRINT LAYOUT REFERENCE 1"),this.state.printLayout=1}},{key:"printLayoutReference2",value:function(){console.log("PRINT LAYOUT REFERENCE 2"),this.state.printLayout=2}},{key:"print",value:function(e){var t=this.load(e),n=(t<0?"-":"+")+t.toFixed(7);console.log("PRINT "+n),1===this.state.printLayout?this.output+=n+"   ":2===this.state.printLayout&&(this.output+=n+"\n")}},{key:"peek",value:function(e){return"01"==e?this.currentTape.peekData().valueOf():this.state.get(e)}},{key:"load",value:function(e){return"01"==e?this.currentTape.readData().valueOf():this.state.get(e)}},{key:"currentTape",get:function(){return this.tapes[this.state.tapeNumber]}}]),e}(),w=n("FCAv"),C=n("+pcE"),m=function e(t,n){_classCallCheck(this,e),this.value=0,this.indicators=t,this.position=n},_=((r=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,null,[{key:"createTube",value:function(e,t){for(var n=2*Math.PI/10,r=[],a=0,o=0;o<10;o++){var i=new f.a(e*Math.cos(a),0,e*Math.sin(a)),s=new f.a(e*Math.cos(a),-t,e*Math.sin(a)),c=new f.a(0,-t,0),u=f.a.zero;a+=n;var l=new f.a(e*Math.cos(a),0,e*Math.sin(a)),h=new f.a(e*Math.cos(a),-t,e*Math.sin(a));this.pushTriangle(r,i,u,l),this.pushTriangle(r,c,s,h),this.pushTriangle(r,i,l,s),this.pushTriangle(r,s,l,h)}return r}},{key:"createTubeRow",value:function(e){for(var t=[],n=this.createTube(.015,.05),r=new f.a(-.23,0,e),a=0;a<5;a++)n.forEach((function(e){t.push(e.add(r))})),r.x+=.0425;r.x+=.1;for(var o=0;o<4;o++)n.forEach((function(e){t.push(e.add(r))})),r.x+=.0425;return t}},{key:"createMemoryUnit",value:function(){for(var e=[],t=0;t<5;t++)this.createTubeRow(t*this.tubeDistance-.22).forEach((function(t){e.push(t)}));for(var n=5;n<10;n++)this.createTubeRow(n*this.tubeDistance-.165).forEach((function(t){e.push(t)}));return e}}]),n}(h.a)).tubeDistance=.0425,r),P=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,o,i){var s;_classCallCheck(this,n),(s=t.call(this,i)).position=o;var c=C.a.withMesh(e,i);c.color=[.5,.5,.5,1],c.worldTransform=w.a.rotationX(Math.PI/2).multiply(w.a.translation(o));var u=C.a.withMesh(new l.a(h.a.createBox(new f.a(.25,.25,.1)),s.gl),i);u.color=[.5,.5,.5,1],u.worldTransform=w.a.translation(o.add(new f.a(0,0,-.15)));var d=C.a.withMesh(r,i);return d.color=[.2,.2,.2,1],d.worldTransform=w.a.rotationX(Math.PI/2).multiply(w.a.translation(o)),s.children=[c,u,d],s.createRegisters(a,i),s}return _createClass(n,[{key:"createRegisters",value:function(e,t){this.registers=[];for(var n=this.position.add(new f.a(-.23,.22,0)),r=0;r<5;r++){var a=this.createIndicators(e,t);this.registers[r]=new m(a,n),n=n.add(new f.a(0,-_.tubeDistance,0))}n=n.add(new f.a(0,-.055,0));for(var o=5;o<10;o++){var i=this.createIndicators(e,t);this.registers[o]=new m(i,n),n=n.add(new f.a(0,-_.tubeDistance,0))}}},{key:"createIndicators",value:function(e,t){for(var n=[],r=0;r<9;r++){var a=C.a.withMesh(e,t);a.program=t.emitterShader,a.color=[1,.2,.2,1],n[r]=a}return n}},{key:"draw",value:function(){var e=this;this.children.forEach((function(e){e.draw()})),this.renderingContext.emitterShader.use(),this.registers.forEach((function(t){for(var n=t.position,r=0;r<5;r++)e.drawIndicator(t,r,n),n=n.add(new f.a(.0425,0,0));n=n.add(new f.a(.1,0,0));for(var a=5;a<9;a++)e.drawIndicator(t,a,n),n=n.add(new f.a(.0425,0,0))})),this.renderingContext.standardShader.use()}},{key:"drawIndicator",value:function(e,t,n){var r=e.indicators[t],a=0;0!==t&&(1===t&&t--,e.value<0&&t++,a=Number(e.value.toFixed(7)[t])*(2*Math.PI/10)),r.worldTransform=w.a.rotationX(Math.PI/2).multiply(w.a.translation(new f.a(0,.0095,0))).multiply(w.a.rotationZ(a)).multiply(w.a.translation(n)),r.draw()}}]),n}(C.a),O=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;_classCallCheck(this,n),(r=t.call(this,e)).processor=new k,r.loadExampleProgram2();var a=new l.a(h.a.createCase(new f.a(.25,.05,.25)),e.gl),o=new l.a(_.createMemoryUnit(),e.gl),i=new l.a(h.a.createBox(new f.a(.0025,.003,.0036)),e.gl),s=r.createMemoryUnitNode(a,o,i,new f.a(-.5,1,0)),c=r.createMemoryUnitNode(a,o,i,new f.a(-.5,.5,0)),u=r.createMemoryUnitNode(a,o,i,new f.a(-.5,0,0)),d=r.createMemoryUnitNode(a,o,i,new f.a(-.5,-.5,0)),p=r.createMemoryUnitNode(a,o,i,new f.a(-1,1,0)),g=r.createMemoryUnitNode(a,o,i,new f.a(-1,.5,0)),v=r.createMemoryUnitNode(a,o,i,new f.a(-1,0,0)),y=r.createMemoryUnitNode(a,o,i,new f.a(-1,-.5,0)),b=r.createMemoryUnitNode(a,o,i,new f.a(-1.5,1,0));return r.memoryBanks=[s,c,u,d,p,g,v,y,b],r.nodes=r.memoryBanks,r.light.position=new f.a(.5,2,.5),r.camera.eye=new f.a(0,.5,3.3),r.camera.target=new f.a(0,.25,0),r.clearColor=[.1,.1,.1,1],r}return _createClass(n,[{key:"createMemoryUnitNode",value:function(e,t,n,r){return new P(e,t,n,r,this.renderingContext)}},{key:"loadExampleProgram1",value:function(){this.processor.setTape(1,"[1]\n20900\n21000\n22000\n23000\n24000\n25000\n10110\n+10000000\n10120\n+01000000\n10130\n+15500000\n03202\n02102\n"),this.processor.setTape(2,"[2]\n11040\n51040\n07300\n11001\n07400\n10901\n12010\n13040\n31040\n01140\n24000\n20900\n05202\n05202\n00100\n")}},{key:"loadExampleProgram2",value:function(){this.processor.setTape(1,"[1]\n20900\n21000\n22000\n23000\n24000\n25000\n10110\n+05000000\n10120\n+90000000\n10130\n+10000000\n10140\n+20000000\n11050\n03202\n02102\n"),this.processor.setTape(2,"[2]\n07400\n11001\n33020\n01220\n05303\n02203\n25009\n64050\n20900\n15010\n03202\n"),this.processor.setTape(3,"[3]\n00100\n")}},{key:"draw",value:function(e){_get(_getPrototypeOf(n.prototype),"draw",this).call(this,e),this.processor.step(),this.copyState(),this.renderingContext.standardShader.use(),this.nodes.forEach((function(e){e.draw()}))}},{key:"copyState",value:function(){for(var e=0;e<9;e++)for(var t=this.memoryBanks[e],n=0;n<10;n++){var r=t.registers[n],a=String(10*(e+1)+n);r.value=this.processor.peek(a)}}}]),n}(d.a),M=n("4u2P"),E=n("fXoL"),N=n("jhN1"),x=n("S8xs"),T=[{path:"",component:(a=function(){function e(t){_classCallCheck(this,e),this.isOrtographicProjection=!1,t.setTitle("Harwell Dekatron")}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this.appCanvas.surface.nativeElement.getContext("webgl");if(e){var t=new M.a(e);this.scene=new O(t),this.appCanvas.setScene(this.scene)}}},{key:"onChangeOrtographicProjection",value:function(){this.isOrtographicProjection=!this.isOrtographicProjection,this.scene.camera.orthographic=this.isOrtographicProjection}}]),e}(),a.\u0275fac=function(e){return new(e||a)(E.Gb(N.b))},a.\u0275cmp=E.Ab({type:a,selectors:[["harwell-component"]],viewQuery:function(e,t){var n;1&e&&E.Zb(u.a,!0),2&e&&E.Wb(n=E.Qb())&&(t.appCanvas=n.first)},decls:13,vars:2,consts:[["id","bodyContainer"],["id","leftPanel"],[3,"isAnimated"],["accordion-heading","","type","button",1,"btn","btn-link","btn-block","clearfix"],[1,"badge","badge-arrow","float-left"],[1,"float-left"],["value","ds","type","checkbox",3,"checked","change"]],template:function(e,t){1&e&&(E.Jb(0,"div",0),E.Jb(1,"div",1),E.Jb(2,"accordion",2),E.Jb(3,"accordion-group"),E.Jb(4,"button",3),E.Jb(5,"span",4),E.bc(6,"\u2b9e"),E.Ib(),E.Jb(7,"span",5),E.bc(8,"Settings"),E.Ib(),E.Ib(),E.Jb(9,"label"),E.Jb(10,"input",6),E.Pb("change",(function(){return t.onChangeOrtographicProjection()})),E.Ib(),E.bc(11," Orthographic projection "),E.Ib(),E.Ib(),E.Ib(),E.Ib(),E.Hb(12,"app-canvas"),E.Ib()),2&e&&(E.wb(2),E.Ub("isAnimated",!0),E.wb(8),E.Ub("checked",t.isOrtographicProjection))},directives:[x.a,x.c,u.a],styles:["#leftPanel[_ngcontent-%COMP%]{width:350px;height:768px;float:left;overflow-y:auto;white-space:normal}#bodyContainer[_ngcontent-%COMP%]{white-space:nowrap}.badge-arrow[_ngcontent-%COMP%]{margin-top:4px;transition-duration:.2s;transition-property:transform}.panel-open[_ngcontent-%COMP%]   .badge-arrow[_ngcontent-%COMP%]{transform:rotate(90deg)}ul[_ngcontent-%COMP%]{padding-left:25px}.gear-group-a[_ngcontent-%COMP%]{background-color:#99801a}.gear-group-l[_ngcontent-%COMP%]{background-color:#e6801a}.gear-group-n[_ngcontent-%COMP%]{background-color:#40bf4d}.gear-group-o[_ngcontent-%COMP%]{background-color:#fff}.gear-group-p[_ngcontent-%COMP%]{background-color:#80bf33}.gear-group-e[_ngcontent-%COMP%]{background-color:#7366b3}.gear-group-h[_ngcontent-%COMP%]{background-color:#a666b3}.gear-group-c[_ngcontent-%COMP%]{background-color:#80bfe6}.gear-group-k[_ngcontent-%COMP%]{background-color:#73ccbf}"]}),a)}],R=((o=function e(){_classCallCheck(this,e)}).\u0275mod=E.Eb({type:o}),o.\u0275inj=E.Db({factory:function(e){return new(e||o)},imports:[[c.a.forChild(T)],c.a]}),o),I=n("YP2Z"),S=((i=function e(){_classCallCheck(this,e)}).\u0275mod=E.Eb({type:i}),i.\u0275inj=E.Db({factory:function(e){return new(e||i)},imports:[[s.b,R,I.a,x.b.forRoot()]]}),i)}}]);