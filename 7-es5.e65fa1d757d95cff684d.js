!function(){function t(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,r,n){return(e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,r,n||t)}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=a(t);if(e){var i=a(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return s(this,r)}}function s(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(u){i=!0,s=u}finally{try{n||null==o.return||o.return()}finally{if(i)throw s}}return r}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=c(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){o=!0,s=t},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw s}}}}function c(t,e){if(t){if("string"==typeof t)return h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,r){return e&&d(t.prototype,e),r&&d(t,r),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"1MA0":function(n,s,c){"use strict";c.r(s),c.d(s,"HarwellModule",function(){return z});var h,d,p,b=c("ofXK"),g=c("tyNb"),v=c("JKqQ"),y=c("NCiM"),m=c("kCbX"),w=c("uhFJ"),k=c("7G6I"),S=function(){function t(){l(this,t),this.data=new Map;for(var e=0;e<=99;e++)this.data[e]=0;this.tapeNumber=1,this.shiftPosition=0}return f(t,[{key:"get",value:function(t){return this.data[t]}},{key:"add",value:function(t,e){var r=this.data[t]+e;0!==this.shiftPosition&&(r*=Math.pow(10,this.shiftPosition),this.shiftPosition=0);var n=Math.trunc(r);if(this.data[t]=n,9==t){var i=Math.round(Math.abs(1e8*r)%1e8);this.data[8]=i}}},{key:"subtract",value:function(t,e){var r=this.data[t]-e;0!==this.shiftPosition&&(r*=Math.pow(10,this.shiftPosition),this.shiftPosition=0);var n=Math.trunc(r);if(this.data[t]=n,9==t){var i=Math.round(Math.abs(1e8*r)%1e8);this.data[8]=i}}},{key:"multiply",value:function(t,e){var r=this.get(t)*this.get(e),n=Math.abs(10*r)%1e7,i=Math.trunc(r/1e7);this.data[8]=n,this.data[9]=i,this.clear(e)}},{key:"divide",value:function(t,e){var r=this.get(t)/1e7,n=Math.trunc(this.get(9)/r),i=Math.trunc(this.get(9)%r);this.data[e]=n,this.data[9]=i}},{key:"clear",value:function(t){this.data[t]=0,9==t&&(this.data[8]=0)}}]),t}(),C=function(){function t(){l(this,t)}return f(t,null,[{key:"getOperation",value:function(e){return Math.trunc(t.getOrderCode(e)/1e4)}},{key:"getAddressA",value:function(e){return Math.trunc(t.getOrderCode(e)/100)%100}},{key:"getAddressB",value:function(e){return t.getOrderCode(e)%100}},{key:"getOrderCode",value:function(t){return Math.trunc(t/1e3)}}]),t}(),A=function(){function t(e,r){l(this,t),this.entries=e,this.blockEntryIndices=r,this.index=0;var n,i=u(r);try{for(i.s();!(n=i.n()).done;){var s=o(n.value,2),a=s[0];if(s[1]===this.index){this.blockNumber=a;break}}}catch(c){i.e(c)}finally{i.f()}}return f(t,[{key:"searchBlock",value:function(t){if(!this.blockEntryIndices.has(t))throw new Error("Block not found on tape after full loop");this.index=this.blockEntryIndices.get(t),this.blockNumber=t}},{key:"read",value:function(){var t=this.peek();return this.index++,this.index>=this.entries.length&&(this.index=0),t}},{key:"peek",value:function(){if(0===this.entries.length)throw new Error("No entry on tape to read.");return this.entries[this.index]}},{key:"peekAhead",value:function(){return this.peekAt(this.index===this.entries.length-1?0:this.index+1)}},{key:"peekAt",value:function(t){if(0===this.entries.length)throw new Error("No entry on tape to read.");return this.entries[t]}}]),t}(),I=function(){function t(){l(this,t),this.tapes=new Map,this.state=new S,this.output=[""]}return f(t,[{key:"setProgram",value:function(t){this.tapes=function(){function t(){l(this,t)}return f(t,null,[{key:"assemble",value:function(t){var e=new Map,r=1,n=[],i=new Map;return t.split("\n").forEach(function(t){if(t.startsWith(";"));else if(t.startsWith("#")){var s=Number(t.substr(1));i.set(s,n.length)}else if(t.startsWith("[")&&t.endsWith("]")){var a=Number(t.substr(1,t.length-2));i.set(a,n.length)}else if("==tape"==t)0!==n.length&&(e[r]=new A(n,i),r++,n=[],i=new Map);else if(5===t.length){var o=1e3*Number(t);n.push(o)}else if(9===t.length){var u=Number(t);n.push(u)}}),e[r]=new A(n,i),e}}]),t}().assemble(t)}},{key:"currentTape",get:function(){return this.state.tapeNumber>7?null:this.tapes[this.state.tapeNumber]}},{key:"currentBlockNumber",get:function(){return null!=this.currentTape?this.currentTape.blockNumber:null}},{key:"peekNextEntry",value:function(){return this.state.tapeNumber>7?this.state.get(this.state.tapeNumber):this.currentTape.peek()}},{key:"readNextEntry",value:function(){if(this.state.tapeNumber>7){var t=this.state.get(this.state.tapeNumber);return this.state.tapeNumber++,t}return this.currentTape.read()}},{key:"step",value:function(){if(!this.state.finished){var t=this.readNextEntry(),e=C.getOperation(t),r=C.getAddressA(t),n=C.getAddressB(t);switch(e){case 0:this.control(r,n);break;case 1:this.add(r,n);break;case 2:this.addAndClear(r,n);break;case 3:this.subtract(r,n);break;case 4:this.subtractAndClear(r,n);break;case 5:this.multiply(r,n);break;case 6:this.divide(r,n);break;case 7:this.transferPositiveModulus(r,n);break;default:throw new Error("Unknown order "+C.getOrderCode(t))}}}},{key:"control",value:function(t,e){if(t>=30&&t<=39)this.searchBlock(t%10,e);else if(t>=50&&t<=59)this.state.yes&&this.searchBlock(t%10,e);else if(t>=70&&t<=79)this.state.printLayout=t%10;else{if(!(t>=81&&t<=89)){switch(t){case 1:0===e&&this.finish();case 11:return void this.testPositive(e);case 12:return void this.testNegative(e);case 21:return void this.transferControl(e);case 22:return void(this.state.yes&&this.transferControl(e))}throw new Error("Unknown control instruction 0"+t+e)}this.state.shiftPosition=-t%10+2}}},{key:"add",value:function(t,e){var r=this.read(t);1!==e?this.state.add(e,r):this.print(r)}},{key:"addAndClear",value:function(t,e){this.add(t,e),this.state.clear(t)}},{key:"subtract",value:function(t,e){var r=this.read(t);1!==e?this.state.subtract(e,r):this.print(r)}},{key:"subtractAndClear",value:function(t,e){this.subtract(t,e),this.state.clear(t)}},{key:"multiply",value:function(t,e){this.state.multiply(t,e)}},{key:"divide",value:function(t,e){this.state.divide(t,e)}},{key:"transferPositiveModulus",value:function(t,e){this.peek(t)<0?this.subtract(t,e):this.add(t,e)}},{key:"testPositive",value:function(t){this.state.yes=this.read(t)>0}},{key:"testNegative",value:function(t){this.state.yes=this.read(t)<0}},{key:"searchBlock",value:function(t,e){this.tapes[e].searchBlock(t)}},{key:"transferControl",value:function(t){this.state.tapeNumber=t}},{key:"finish",value:function(){this.state.finished=!0}},{key:"print",value:function(t){var e=(t<0?"":"+")+(t/1e7).toFixed(7);switch(this.state.printLayout){case 0:this.output.push("","","","","");break;case 3:this.output[this.output.length-1]+=e+"   ";break;case 4:this.output[this.output.length-1]+=e,this.output.push("")}}},{key:"peek",value:function(t){return t>0&&t<8?this.tapes[t].peekData():this.state.get(t)}},{key:"peekAhead",value:function(t){return t>0&&t<8?this.tapes[t].peekAhead():this.peek(t)}},{key:"read",value:function(t){return t>0&&t<8?this.tapes[t].read():this.state.get(t)}}]),t}(),P=c("FCAv"),M=c("+pcE"),O=((d=function(t){r(n,t);var e=i(n);function n(t,r,i){var s;return l(this,n),(s=e.call(this,i)).renderingContext=i,s.statusFlag=!1,s.activeColorValue=n.activeRegisterColor,s.passiveColorValue=n.passiveRegisterColor,s.meshes=[t],s.color=s.passiveColor,s.program=i.emitterShader,s.position=r,s.worldTransform=P.a.translation(s.position),s}return f(n,[{key:"status",get:function(){return this.statusFlag},set:function(t){this.statusFlag=t,this.color=this.statusFlag?this.activeColorValue:this.passiveColorValue}},{key:"activeColor",get:function(){return this.activeColorValue},set:function(t){this.activeColorValue=t,this.statusFlag&&(this.color=this.activeColorValue)}},{key:"passiveColor",get:function(){return this.passiveColorValue},set:function(t){this.passiveColorValue=t,this.statusFlag||(this.color=this.passiveColorValue)}}]),n}(M.a)).activeRegisterColor=[1,1,1,1],d.passiveRegisterColor=[.2,.2,.2,1],d.passiveStoreColor=[0,.2,0,1],d.activeStoreColor=[0,1,0,1],d.passiveReadColor=[.2,0,0,1],d.activeReadColor=[1,0,0,1],d),T=((h=function(t){r(n,t);var e=i(n);function n(t,r){var i;return l(this,n),(i=e.call(this,r)).renderingContext=r,i.meshes=[t],i.color=n.passiveColor,i.program=r.emitterShader,i.position=w.a.zero,i}return f(n,[{key:"digit",get:function(){return this.currentDigit},set:function(t){if(this.currentDigit!==t){this.currentDigit=t;var e=t*(2*Math.PI/10);this.worldTransform=P.a.rotationX(Math.PI/2).multiply(P.a.translation(new w.a(0,.0095,0))).multiply(P.a.rotationZ(e)).multiply(P.a.translation(this.position))}}}]),n}(M.a)).activeColor=[1,.2,.2,1],h.passiveColor=[.6,.12,.12,1],h),x=function(){function t(e){l(this,t),this.isActive=!1,this.indicators=e,this.hasSignDigit=9===e.length}return f(t,[{key:"value",set:function(t){if(this.currentValue!==t)if(null==t?(this.setActive(!1),t=0):this.setActive(!0),this.currentValue=t,this.hasSignDigit){this.indicators[0].digit=this.getSignDigit();for(var e=0;e<8;e++)this.indicators[e+1].digit=this.getDigit(e)}else for(var r=0;r<8;r++)this.indicators[r].digit=this.getDigit(r)}},{key:"getSignDigit",value:function(){return this.currentValue>=0?0:9}},{key:"getDigit",value:function(t){return Math.round(Math.abs(this.currentValue)/Math.pow(10,7-t))%10}},{key:"setActive",value:function(t){if(this.isActive!==t){this.isActive=t;var e,r=u(this.indicators);try{for(r.s();!(e=r.n()).done;){e.value.color=t?T.activeColor:T.passiveColor}}catch(n){r.e(n)}finally{r.f()}}}}]),t}(),N=((p=function(t){r(n,t);var e=i(n);function n(){return l(this,n),e.apply(this,arguments)}return f(n,null,[{key:"createTube",value:function(t,e){for(var r=2*Math.PI/10,n=[],i=0,s=0;s<10;s++){var a=new w.a(t*Math.cos(i),0,t*Math.sin(i)),o=new w.a(t*Math.cos(i),-e,t*Math.sin(i)),u=new w.a(0,-e,0),c=w.a.zero;i+=r;var h=new w.a(t*Math.cos(i),0,t*Math.sin(i)),l=new w.a(t*Math.cos(i),-e,t*Math.sin(i));this.pushTriangle(n,a,c,h),this.pushTriangle(n,u,o,l),this.pushTriangle(n,a,h,o),this.pushTriangle(n,o,h,l)}return n}},{key:"createTubeRow",value:function(t){for(var e=[],r=this.createTube(this.tubeRadius,this.tubeHeight),n=new w.a(-.23,0,t),i=0;i<5;i++)this.appendWithOffset(e,r,n),n.x+=this.tubeDistance;n.x+=this.memoryRegisterMiddleGap;for(var s=0;s<4;s++)this.appendWithOffset(e,r,n),n.x+=this.tubeDistance;return e}},{key:"createAccumulatorTubeRow",value:function(){for(var t=[],e=this.createTube(this.tubeRadius,this.tubeHeight),r=new w.a(-.15,0,.1),n=0;n<8;n++)this.appendWithOffset(t,e,r),r.x+=this.tubeDistance;return t}},{key:"createMemoryUnit",value:function(){for(var t=[],e=0;e<5;e++){var r=this.createTubeRow(e*this.tubeDistance-.22);this.append(t,r)}for(var n=5;n<10;n++){var i=this.createTubeRow(n*this.tubeDistance-.165);this.append(t,i)}return t}},{key:"createAccumulator",value:function(){return this.createAccumulatorTubeRow()}}]),n}(m.a)).tubeDistance=.0425,p.tubeRadius=.015,p.tubeHeight=.05,p.memoryRegisterMiddleGap=.1,p),E=function(t){r(n,t);var e=i(n);function n(t,r,i,s,a,o){var u;l(this,n),(u=e.call(this,o)).position=a;var c=M.a.withMesh(t,o);c.color=[.5,.5,.5,1],c.worldTransform=P.a.rotationX(Math.PI/2).multiply(P.a.translation(a));var h=M.a.withMesh(new y.a(m.a.createBox(new w.a(.25,.25,.1)),u.gl),o);h.color=[.5,.5,.5,1],h.worldTransform=P.a.translation(a.add(new w.a(0,0,-.15)));var d=M.a.withMesh(r,o);d.color=[.2,.2,.2,1],d.worldTransform=P.a.rotationX(Math.PI/2).multiply(P.a.translation(a));var f=M.a.withMesh(new y.a(m.a.createBox(new w.a(.05,.035,.02)),u.gl),o);return f.color=[.2,.2,.2,1],f.worldTransform=P.a.translation(a.add(new w.a(.01,0,0))),u.children=[c,h,d,f],u.createRegisters(i,o),u.createStatusLights(s,o),u}return f(n,[{key:"createStatusLights",value:function(t,e){this.storeStatusLight=this.createStatusLight(this.position.add(new w.a(-.02,.015,.02)),t,e),this.storeStatusLight.activeColor=O.activeStoreColor,this.storeStatusLight.passiveColor=O.passiveStoreColor,this.readStatusLight=this.createStatusLight(this.position.add(new w.a(.04,.015,.02)),t,e),this.readStatusLight.activeColor=O.activeReadColor,this.readStatusLight.passiveColor=O.passiveReadColor,this.statusLights=[this.createStatusLight(this.position.add(new w.a(0,.015,.02)),t,e),this.createStatusLight(this.position.add(new w.a(.02,.015,.02)),t,e),this.createStatusLight(this.position.add(new w.a(-.02,0,.02)),t,e),this.createStatusLight(this.position.add(new w.a(0,0,.02)),t,e),this.createStatusLight(this.position.add(new w.a(.02,0,.02)),t,e),this.createStatusLight(this.position.add(new w.a(.04,0,.02)),t,e),this.createStatusLight(this.position.add(new w.a(-.02,-.015,.02)),t,e),this.createStatusLight(this.position.add(new w.a(0,-.015,.02)),t,e),this.createStatusLight(this.position.add(new w.a(.02,-.015,.02)),t,e),this.createStatusLight(this.position.add(new w.a(.04,-.015,.02)),t,e)]}},{key:"createStatusLight",value:function(t,e,r){return new O(e,t,r)}},{key:"createRegisters",value:function(t,e){this.registers=[];for(var r=this.position.add(new w.a(-.23,-.2175,0)),n=0;n<5;n++){var i=this.createIndicators(t,e),s=new x(i);this.setIndicatorPositions(s,r),this.registers[n]=s,r=r.add(new w.a(0,N.tubeDistance,0))}r=r.add(new w.a(0,.055,0));for(var a=5;a<10;a++){var o=this.createIndicators(t,e),u=new x(o);this.setIndicatorPositions(u,r),this.registers[a]=u,r=r.add(new w.a(0,N.tubeDistance,0))}}},{key:"createIndicators",value:function(t,e){for(var r=[],n=0;n<9;n++)r[n]=new T(t,e);return r}},{key:"setIndicatorPositions",value:function(t,e){for(var r=e.copy(),n=0;n<5;n++)t.indicators[n].position=r.copy(),r.x+=N.tubeDistance;r.x+=N.memoryRegisterMiddleGap;for(var i=5;i<9;i++)t.indicators[i].position=r.copy(),r.x+=N.tubeDistance}},{key:"draw",value:function(){this.children.forEach(function(t){t.draw()}),this.renderingContext.emitterShader.use(),this.registers.forEach(function(t){var e,r=u(t.indicators);try{for(r.s();!(e=r.n()).done;){e.value.draw()}}catch(n){r.e(n)}finally{r.f()}}),this.storeStatusLight.draw(),this.readStatusLight.draw(),this.statusLights.forEach(function(t){t.draw()}),this.renderingContext.standardShader.use()}}]),n}(M.a),R=function(){function t(e){l(this,t),this.processor=e}return f(t,[{key:"disassemble",value:function(t){return(t/1e3).toString().padStart(5,"0")+" "+this.disassembleInstruction(t)}},{key:"disassembleInstruction",value:function(t){switch(C.getOperation(t)){case 0:return this.disassembleControl(t);case 1:return this.disassembleAdd(t);case 2:return this.disassembleAddAndClear(t);case 3:return this.disassembleSubtract(t);case 4:return this.disassembleSubtractAndClear(t);case 5:return this.disassembleMultiply(t);case 6:return this.disassembleDivide(t);case 7:return this.disassembleTransferPositiveModulus(t);default:throw new Error("Unknown order "+C.getOrderCode(t))}}},{key:"disassembleControl",value:function(t){var e=C.getAddressA(t),r=C.getAddressB(t);if(e>=30&&e<=39)return"SEARCH for block "+e%10+" on tape "+r;if(e>=50&&e<=59)return"CONDITIONAL SEARCH for block "+e%10+" on tape "+r+" ("+(this.processor.state.yes?"YES":"NO")+")";if(e>=70&&e<=79)return"PRINT LAYOUT "+e%10;if(e>=81&&e<=89){var n=-e%10+2;return"SELECT SHIFT POSITION "+String.fromCharCode("A".charCodeAt(0)-n+1)+" (10^"+n+")"}switch(e){case 1:if(0===r)return"FINISH";case 11:return"TEST POSITIVE ["+r+"] ("+this.format(this.processor.peek(r))+")";case 12:return"TEST NEGATIVE ["+r+"] ("+this.format(this.processor.peek(r))+")";case 21:return"TRANSFER to "+(r<10?"tape ":"")+r;case 22:return"CONDITIONAL TRANSFER to "+r+" ("+(this.processor.state.yes?"YES":"NO")+")";case 85:return"SHIFT";default:throw new Error("Unknown control order "+C.getOrderCode(t))}}},{key:"disassembleAdd",value:function(t){var e=C.getAddressA(t),r=C.getAddressB(t),n=this.processor.peekAhead(e),i=this.format(n);if(1===r)return"PRINT ["+e+"] ("+i+")";var s=this.processor.peek(r);return"["+r+"] += ["+e+"] ("+this.format(s)+" + "+i+" = "+this.format(s+n)+")"}},{key:"disassembleAddAndClear",value:function(t){var e=C.getAddressA(t),r=C.getAddressB(t),n=this.processor.peekAhead(e),i=this.format(n);if(0===r)return"CLEAR ["+e+"] ("+i+")";if(1===r)return"PRINT ["+e+"] ("+i+")";var s=this.processor.peek(r);return"["+r+"] += ["+e+"]; CLEAR ["+e+"] ("+this.format(s)+" + "+i+" = "+this.format(s+n)+")"}},{key:"disassembleSubtract",value:function(t){var e=C.getAddressA(t),r=C.getAddressB(t),n=this.processor.peekAhead(e),i=this.format(n);if(0===r)return"CLEAR ["+e+"] ("+i+")";if(1===r)return"PRINT ["+e+"] ("+i+")";var s=this.processor.peek(r);return"["+r+"] -= ["+e+"]; CLEAR ["+e+"] ("+this.format(s)+" - "+i+" = "+this.format(s-n)+")"}},{key:"disassembleSubtractAndClear",value:function(t){var e=C.getAddressA(t),r=C.getAddressB(t),n=this.processor.peekAhead(e),i=this.processor.peek(r);return"["+r+"] -= ["+e+"] ("+this.format(i)+" - "+this.format(n)+" = "+this.format(i-n)+")"}},{key:"disassembleMultiply",value:function(t){var e=C.getAddressA(t),r=C.getAddressB(t),n=this.processor.peek(e),i=this.processor.peek(r);return"[09] = ["+e+"] * ["+r+"] ("+this.format(i)+" * "+this.format(i)+" = "+this.format(n*i/1e7)+")"}},{key:"disassembleDivide",value:function(t){var e=C.getAddressA(t),r=C.getAddressB(t),n=this.processor.peek(9),i=this.processor.peek(e),s=this.format(n),a=this.format(i);return"["+r+"] = [09] / ["+e+"] ("+s+" / "+a+" = "+this.format(n/i*1e7)+"); [09] = [09] % ["+e+"] ("+s+" % "+a+" = "+this.format(n%i)+")"}},{key:"disassembleTransferPositiveModulus",value:function(t){var e=C.getAddressA(t);return this.processor.peek(e)<0?"TRANSFER POSITIVE MODULUS: "+this.disassembleSubtract(t):"TRANSFER POSITIVE MODULUS: "+this.disassembleAdd(t)}},{key:"format",value:function(t){return t>=1&&t<=9?"0.000000"+t:t>=-9&&t<=-1?"-0.000000"+-t:(t/1e7).toString()}}]),t}(),L=function t(e,r,n){l(this,t),this.id=e,this.title=r,this.text=n},D=function(){function t(){l(this,t)}return f(t,null,[{key:"programList",get:function(){return[new L("1","Example program 1","\n[1]\n20900\n21000\n22000\n23000\n24000\n25000\n10110\n+10000000\n10120\n+01000000\n10130\n+15500000\n03202\n02102\n\n==tape\n[2]\n11040\n51040\n07300\n11001\n07400\n10901\n12010\n13040\n31040\n01140\n24000\n20900\n05202\n00100"),new L("2","Example program 2","\n[1]\n20900\n21000\n22000\n23000\n24000\n25000\n10110\n+05000000\n10120\n+90000000\n10130\n+10000000\n10140\n+20000000\n11050\n03202\n02102\n\n==tape\n[2]\n07400\n11001\n33020\n01220\n05303\n02203\n25009\n64050\n20900\n15010\n03202\n\n==tape\n[3]\n00100")]}}]),t}(),J=function(t){r(n,t);var e=i(n);function n(t,r,i,s,a){var o;l(this,n),(o=e.call(this,a)).position=s;var u=M.a.withMesh(t,a);u.color=[.5,.5,.5,1],u.worldTransform=P.a.rotationX(Math.PI/2).multiply(P.a.translation(s));var c=M.a.withMesh(new y.a(m.a.createBox(new w.a(.25,.25,.1)),o.gl),a);c.color=[.5,.5,.5,1],c.worldTransform=P.a.translation(s.add(new w.a(0,0,-.15)));var h=M.a.withMesh(r,a);return h.color=[.2,.2,.2,1],h.worldTransform=P.a.rotationX(Math.PI/2).multiply(P.a.translation(s)),o.children=[u,c,h],o.createRegister(i,a),o}return f(n,[{key:"createRegister",value:function(t,e){var r=this.position.add(new w.a(-.15,-.1,0)),n=this.createIndicators(t,e);this.register=new x(n),this.setIndicatorPositions(r)}},{key:"createIndicators",value:function(t,e){for(var r=[],n=0;n<8;n++)r[n]=new T(t,e);return r}},{key:"setIndicatorPositions",value:function(t){for(var e=t.copy(),r=0;r<8;r++)this.register.indicators[r].position=e.copy(),e.x+=N.tubeDistance}},{key:"draw",value:function(){this.children.forEach(function(t){t.draw()}),this.renderingContext.emitterShader.use();var t,e=u(this.register.indicators);try{for(e.s();!(t=e.n()).done;){t.value.draw()}}catch(r){e.e(r)}finally{e.f()}this.renderingContext.standardShader.use()}}]),n}(M.a),j=function(n){r(o,n);var s=i(o);function o(e){var r;l(this,o),(r=s.call(this,e)).isSingleStepping=!0,r.isSingleStepDone=!0,r.isInErrorState=!1,r.programList=D.programList,r.processor=new I,r.disassembler=new R(r.processor);var n=new y.a(m.a.createCase(new w.a(.25,.05,.25)),e.gl),i=new y.a(N.createMemoryUnit(),e.gl),a=new y.a(m.a.createBox(new w.a(.0025,.003,.0036)),e.gl),u=new y.a(m.a.createBox(new w.a(.003,.003,.0036)),e.gl),c=new y.a(N.createAccumulator(),e.gl),h=r.createMemoryUnitNode(n,i,a,u,new w.a(-.5,-.5,0)),d=r.createMemoryUnitNode(n,i,a,u,new w.a(-.5,0,0)),f=r.createMemoryUnitNode(n,i,a,u,new w.a(-.5,.5,0)),p=r.createMemoryUnitNode(n,i,a,u,new w.a(-.5,1,0)),b=r.createMemoryUnitNode(n,i,a,u,new w.a(-1,-.5,0)),g=r.createMemoryUnitNode(n,i,a,u,new w.a(-1,0,0)),v=r.createMemoryUnitNode(n,i,a,u,new w.a(-1,.5,0)),k=r.createMemoryUnitNode(n,i,a,u,new w.a(-1,1,0)),S=r.createMemoryUnitNode(n,i,a,u,new w.a(-1.5,1,0));return r.accumulator8=r.createAccumulatorNode(n,c,a,new w.a(0,-.35,0)),r.accumulator9=r.createAccumulatorNode(n,c,a,new w.a(0,.5,0)),r.memoryBanks=[h,d,f,p,b,g,v,k,S],r.nodes=[].concat(t(r.memoryBanks),[r.accumulator8,r.accumulator9]),r.light.position=new w.a(.5,2,.5),r.camera.eye=new w.a(0,.5,3.3),r.camera.target=new w.a(0,.25,0),r.clearColor=[.1,.1,.1,1],r.camera.orthoScaling=2.7,r.loadFirstProgram(),r}return f(o,[{key:"createMemoryUnitNode",value:function(t,e,r,n,i){return new E(t,e,r,n,i,this.renderingContext)}},{key:"createAccumulatorNode",value:function(t,e,r,n){return new J(t,e,r,n,this.renderingContext)}},{key:"onProgramChange",value:function(t){var e=this.programList.find(function(e){return e.id===t});this.processor.setProgram(e.text),this.resetProgram()}},{key:"loadFirstProgram",value:function(){this.onProgramChange(this.programList[0].id)}},{key:"resetProgram",value:function(){this.processor.output=[""],this.isSingleStepping=!0,this.isSingleStepDone=!0,this.isInErrorState=!1,this.errorText=void 0,this.processor.state.finished=!1,this.processor.state.tapeNumber=1,this.processor.state.shiftPosition=0,this.setIndicatorsPassive(),this.disassembleNextInstruction()}},{key:"draw",value:function(t){e(a(o.prototype),"draw",this).call(this,t);try{this.isInErrorState||this.runProcessorForFrame()}catch(r){console.error(r),this.errorText=r.message,this.isInErrorState=!0}this.copyStateToRenderObject(),this.renderingContext.standardShader.use(),this.nodes.forEach(function(t){t.draw()})}},{key:"stepProcessor",value:function(){this.isSingleStepping=!0,this.isSingleStepDone=!1}},{key:"runProcessor",value:function(){this.isSingleStepping=!this.isSingleStepping}},{key:"runProcessorForFrame",value:function(){this.isSingleStepping?this.isSingleStepDone||(this.processor.step(),this.disassembleNextInstruction(),this.isSingleStepDone=!0):(this.processor.step(),this.disassembleNextInstruction()),this.processor.state.finished&&(this.isSingleStepping=!0)}},{key:"copyStateToRenderObject",value:function(){var t=this.processor.peekNextEntry(),e=C.getOperation(t),r=C.getAddressA(t),n=C.getAddressB(t),i=0!==e,s=2===e||4===e;this.accumulator8.register.value=this.processor.peek(8),this.accumulator9.register.value=this.processor.peek(9);for(var a=0;a<9;a++){for(var o=this.memoryBanks[a],u=!1,c=!1,h=0;h<10;h++){var l=10*(a+1)+h;o.registers[h].value=this.processor.peek(l);var d=!1;i&&(l==r&&(u=!0,d=!0,s&&(c=!0,d=!0)),l==n&&(c=!0,d=!0)),o.statusLights[h].status=d}o.readStatusLight.status=u,o.storeStatusLight.status=c}}},{key:"setIndicatorsPassive",value:function(){for(var t=0;t<9;t++)for(var e=this.memoryBanks[t],r=0;r<10;r++){var n=e.registers[r];0!==n.value&&void 0!==n.value||(n.value=null)}}},{key:"disassembleNextInstruction",value:function(){var t;t=this.processor.state.tapeNumber>7?this.processor.state.get(this.processor.state.tapeNumber):this.processor.currentTape.peek(),this.nextInstructionText=this.processor.state.finished?"(finished)":this.disassembler.disassemble(t),console.log(this.nextInstructionText)}}]),o}(k.a),B=c("4u2P"),F=c("fXoL"),_=c("jhN1"),U=c("S8xs");function V(t,e){if(1&t&&(F.Jb(0,"option",18),F.Zb(1),F.Ib()),2&t){var r=e.$implicit;F.Tb("value",r.id),F.wb(1),F.ac(r.title)}}function Z(t,e){if(1&t&&(F.Jb(0,"p",19),F.Zb(1),F.Ib()),2&t){var r=F.Qb();F.wb(1),F.ac(r.scene.errorText)}}function H(t,e){if(1&t&&(F.Jb(0,"p",13),F.Zb(1),F.Hb(2,"br"),F.Ib()),2&t){var r=e.$implicit;F.wb(1),F.ac(r)}}var X,W,Y,G=[{path:"",component:(X=function(){function t(e){l(this,t),this.isOrtographicProjection=!1,e.setTitle("Harwell Dekatron")}return f(t,[{key:"ngOnInit",value:function(){var t=this.appCanvas.surface.nativeElement.getContext("webgl");if(t){var e=new B.a(t);this.scene=new j(e),this.appCanvas.setScene(this.scene)}}},{key:"onChangeOrtographicProjection",value:function(){this.isOrtographicProjection=!this.isOrtographicProjection,this.scene.camera.orthographic=this.isOrtographicProjection}}]),t}(),X.\u0275fac=function(t){return new(t||X)(F.Gb(_.b))},X.\u0275cmp=F.Ab({type:X,selectors:[["harwell-component"]],viewQuery:function(t,e){var r;1&t&&F.dc(v.a,3),2&t&&F.Vb(r=F.Pb())&&(e.appCanvas=r.first)},decls:41,vars:13,consts:[["id","bodyContainer"],["id","leftPanel"],[3,"isAnimated"],[3,"isOpen"],["accordion-heading","","type","button",1,"btn","btn-link","btn-block","clearfix"],[1,"badge","badge-arrow","float-left"],[1,"float-left"],[1,"mb-3",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"btn-toolbar","mb-3"],["type","button",1,"btn","btn-primary","mr-2",3,"disabled","click"],["type","button",1,"btn","btn-primary","mr-4",3,"disabled","click"],["type","button",1,"btn","btn-primary","mr-2",3,"click"],[1,"mb-0"],[2,"min-height","5em"],["class","text-danger",4,"ngIf"],["class","mb-0",4,"ngFor","ngForOf"],["value","ds","type","checkbox",3,"checked","change"],[3,"value"],[1,"text-danger"]],template:function(t,e){1&t&&(F.Jb(0,"div",0),F.Jb(1,"div",1),F.Jb(2,"accordion",2),F.Jb(3,"accordion-group",3),F.Jb(4,"button",4),F.Jb(5,"span",5),F.Zb(6,"\u2b9e"),F.Ib(),F.Jb(7,"span",6),F.Zb(8,"Control"),F.Ib(),F.Ib(),F.Jb(9,"select",7),F.Ob("change",function(t){return e.scene.onProgramChange(t.target.value)}),F.Yb(10,V,2,2,"option",8),F.Ib(),F.Jb(11,"div",9),F.Jb(12,"button",10),F.Ob("click",function(){return e.scene.stepProcessor()}),F.Zb(13,"Step"),F.Ib(),F.Jb(14,"button",11),F.Ob("click",function(){return e.scene.runProcessor()}),F.Zb(15),F.Ib(),F.Jb(16,"button",12),F.Ob("click",function(){return e.scene.resetProgram()}),F.Zb(17,"Reload "),F.Ib(),F.Hb(18,"br"),F.Ib(),F.Jb(19,"p",13),F.Zb(20),F.Ib(),F.Jb(21,"p",14),F.Zb(22),F.Ib(),F.Yb(23,Z,2,1,"p",15),F.Ib(),F.Jb(24,"accordion-group",3),F.Jb(25,"button",4),F.Jb(26,"span",5),F.Zb(27,"\u2b9e"),F.Ib(),F.Jb(28,"span",6),F.Zb(29,"Output"),F.Ib(),F.Ib(),F.Yb(30,H,3,1,"p",16),F.Ib(),F.Jb(31,"accordion-group"),F.Jb(32,"button",4),F.Jb(33,"span",5),F.Zb(34,"\u2b9e"),F.Ib(),F.Jb(35,"span",6),F.Zb(36,"Settings"),F.Ib(),F.Ib(),F.Jb(37,"label"),F.Jb(38,"input",17),F.Ob("change",function(){return e.onChangeOrtographicProjection()}),F.Ib(),F.Zb(39," Orthographic projection "),F.Ib(),F.Ib(),F.Ib(),F.Ib(),F.Hb(40,"app-canvas"),F.Ib()),2&t&&(F.wb(2),F.Tb("isAnimated",!0),F.wb(1),F.Tb("isOpen",!0),F.wb(7),F.Tb("ngForOf",e.scene.programList),F.wb(2),F.Tb("disabled",e.scene.processor.state.finished),F.wb(2),F.Tb("disabled",e.scene.processor.state.finished),F.wb(1),F.bc(" ",e.scene.isSingleStepping?"Run":"Stop"," "),F.wb(5),F.cc("Tape ",e.scene.processor.state.tapeNumber,", block ",e.scene.processor.currentBlockNumber,""),F.wb(2),F.bc("Order: ",e.scene.nextInstructionText,""),F.wb(1),F.Tb("ngIf",e.scene.isInErrorState),F.wb(1),F.Tb("isOpen",!0),F.wb(6),F.Tb("ngForOf",e.scene.processor.output),F.wb(8),F.Tb("checked",e.isOrtographicProjection))},directives:[U.a,U.c,b.i,b.j,v.a],styles:["#leftPanel[_ngcontent-%COMP%]{width:350px;height:768px;float:left;overflow-y:auto;white-space:normal}#bodyContainer[_ngcontent-%COMP%]{white-space:nowrap}.badge-arrow[_ngcontent-%COMP%]{margin-top:4px;transition-duration:.2s;transition-property:transform}.panel-open[_ngcontent-%COMP%]   .badge-arrow[_ngcontent-%COMP%]{transform:rotate(90deg)}ul[_ngcontent-%COMP%]{padding-left:25px}.gear-group-a[_ngcontent-%COMP%]{background-color:#99801a}.gear-group-l[_ngcontent-%COMP%]{background-color:#e6801a}.gear-group-n[_ngcontent-%COMP%]{background-color:#40bf4d}.gear-group-o[_ngcontent-%COMP%]{background-color:#fff}.gear-group-p[_ngcontent-%COMP%]{background-color:#80bf33}.gear-group-e[_ngcontent-%COMP%]{background-color:#7366b3}.gear-group-h[_ngcontent-%COMP%]{background-color:#a666b3}.gear-group-c[_ngcontent-%COMP%]{background-color:#80bfe6}.gear-group-k[_ngcontent-%COMP%]{background-color:#73ccbf}"]}),X)}],Q=((W=function t(){l(this,t)}).\u0275fac=function(t){return new(t||W)},W.\u0275mod=F.Eb({type:W}),W.\u0275inj=F.Db({imports:[[g.a.forChild(G)],g.a]}),W),$=c("YP2Z"),z=((Y=function t(){l(this,t)}).\u0275fac=function(t){return new(t||Y)},Y.\u0275mod=F.Eb({type:Y}),Y.\u0275inj=F.Db({imports:[[b.b,Q,$.a,U.b.forRoot()]]}),Y)}}])}();