(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"1MA0":function(t,e,s){"use strict";s.r(e),s.d(e,"HarwellModule",(function(){return I}));var r=s("ofXK"),n=s("tyNb"),a=s("JKqQ"),o=s("NCiM"),i=s("kCbX"),c=s("uhFJ"),h=s("7G6I");class d{constructor(){this.data={};for(let t=1;t<=99;t++)this.data[String(t).padStart(2,"0")]=0;this.tapeNumber=1}get(t){return this.data[t]}add(t,e){this.data[t]=Number((this.data[t]+e).toFixed(7))}subtract(t,e){this.data[t]=Number((this.data[t]-e).toFixed(7))}multiply(t,e){const s=this.get(t)*this.get(e);this.data["09"]=Number(s.toFixed(7)),this.clear(e)}divide(t,e){const s=this.get("09")/this.get(t),r=this.get("09")%this.get(t);this.data[e]=Number(s.toFixed(7)),this.data["09"]=Number(r.toFixed(7))}clear(t){this.data[t]=0}}class l{constructor(t){this.code=t}static fromCode(t){return new l(t)}get operation(){return this.code[0]}get addressA(){return this.code.substr(1,2)}get addressB(){return this.code.substr(3,2)}}class u{constructor(t){this.value=t}valueOf(){return this.value}}class p{constructor(t){this.blockNumber=t}}class g{constructor(t){this.entries=t,this.index=0}static parse(t){const e=[];return t.split("\n").forEach(t=>{if(5===t.length)e.push(l.fromCode(t));else if(9===t.length){const s=Number(t)/1e7;e.push(new u(s))}else if(3===t.length){const s=Number(t.substr(1,1));e.push(new p(s))}}),new g(e)}searchBlock(t){const e=this.index;for(;;){const s=this.readEntry();if(s instanceof p&&s.blockNumber===t)return;if(this.index===e)throw new Error("Block not found on tape after full loop")}}readInstruction(){return this.readEntry()}readData(){return this.readEntry()}peekData(){return this.peekEntry()}readEntry(){const t=this.peekEntry();return this.index++,this.index>=this.entries.length&&(this.index=0),t}peekEntry(){if(0===this.entries.length)throw new Error("No entry on tape to read.");return this.entries[this.index]}}class b{constructor(){this.tapes=new Map,this.state=new d,this.output=""}setTape(t,e){this.tapes[t]=g.parse(e)}get currentTape(){return this.tapes[this.state.tapeNumber]}step(){if(this.state.finished)return;const t=this.currentTape.readEntry();if(t instanceof p)return;const e=t;switch(e.operation){case"0":this.control(e.addressA,e.addressB);break;case"1":this.add(e.addressA,e.addressB);break;case"2":this.addAndClear(e.addressA,e.addressB);break;case"3":this.subtract(e.addressA,e.addressB);break;case"4":this.subtractAndClear(e.addressA,e.addressB);break;case"5":this.multiply(e.addressA,e.addressB);break;case"6":this.divide(e.addressA,e.addressB);break;default:throw new Error("Unknown instruction "+e.code)}}control(t,e){if("3"!==t[0]){if("5"!==t[0]){switch(t){case"01":return void("00"===e&&this.finish());case"11":return void this.testPositive(e);case"12":return void this.testNegative(e);case"21":return void this.transferControl(e);case"22":return void(this.state.yes&&this.transferControl(e));case"73":return void this.printLayoutReference1();case"74":return void this.printLayoutReference2()}throw new Error("Unknown control instruction 0"+t+e)}if(this.state.yes){const s=Number(t[1]),r=Number(e);this.searchBlock(s,r)}else console.log("NO TRANSFER")}else{const s=Number(t[1]),r=Number(e);this.searchBlock(s,r)}}add(t,e){if("01"===e)return void this.print(t);const s=this.peek(e),r=this.load(t);console.log("["+e+"] += ["+t+"] ("+s+" + "+r+" = "+(s+r).toFixed(7)+")"),this.state.add(e,r)}addAndClear(t,e){"00"===e?console.log("Clear "+t):this.add(t,e),this.state.clear(t)}subtract(t,e){if("01"===e)return void this.print(t);const s=this.peek(e),r=this.load(t);console.log("["+e+"] -= ["+t+"] ("+s+" - "+r+" = "+(s-r).toFixed(7)+")"),this.state.subtract(e,r)}subtractAndClear(t,e){"00"===e?console.log("Clear "+t):this.subtract(t,e),this.state.clear(t)}multiply(t,e){const s=this.peek(t),r=this.peek(t);console.log("[09] = ["+t+"] * ["+e+"] ("+s+" * "+r+" = "+(s*r).toFixed(7)+")"),this.state.multiply(t,e)}divide(t,e){const s=this.peek("09"),r=this.peek(t);console.log("["+e+"] = [09] / ["+t+"] ("+s+" / "+r+" = "+(s/r).toFixed(7)+")"),console.log("[09] = [09] % ["+t+"] ("+s+" % "+r+" = "+(s%r).toFixed(7)+")"),this.state.divide(t,e)}testPositive(t){console.log("TEST POSITIVE ["+t+"] ("+this.peek(t)+")"),this.state.yes=this.load(t)>0}testNegative(t){console.log("TEST NEGATIVE ["+t+"] ("+this.peek(t)+")"),this.state.yes=this.load(t)<0}searchBlock(t,e){console.log("SEARCH for block "+t+" on tape "+e),this.tapes[e].searchBlock(t)}transferControl(t){console.log("TRANFER to "+t),this.state.tapeNumber=Number(t)}finish(){console.log("FINISH"),this.state.finished=!0,console.log(this.output)}printLayoutReference1(){console.log("PRINT LAYOUT REFERENCE 1"),this.state.printLayout=1}printLayoutReference2(){console.log("PRINT LAYOUT REFERENCE 2"),this.state.printLayout=2}print(t){const e=this.load(t),s=(e<0?"-":"+")+e.toFixed(7);console.log("PRINT "+s),1===this.state.printLayout?this.output+=s+"   ":2===this.state.printLayout&&(this.output+=s+"\n")}peek(t){return"01"==t?this.currentTape.peekData().valueOf():this.state.get(t)}load(t){return"01"==t?this.currentTape.readData().valueOf():this.state.get(t)}}var w=s("FCAv"),f=s("+pcE");class m{constructor(t,e){this.value=0,this.indicators=t,this.position=e}}let y=(()=>{class t extends i.a{static createTube(t,e){const s=2*Math.PI/10,r=[];let n=0;for(let a=0;a<10;a++){const a=new c.a(t*Math.cos(n),0,t*Math.sin(n)),o=new c.a(t*Math.cos(n),-e,t*Math.sin(n)),i=new c.a(0,-e,0),h=c.a.zero;n+=s;const d=new c.a(t*Math.cos(n),0,t*Math.sin(n)),l=new c.a(t*Math.cos(n),-e,t*Math.sin(n));this.pushTriangle(r,a,h,d),this.pushTriangle(r,i,o,l),this.pushTriangle(r,a,d,o),this.pushTriangle(r,o,d,l)}return r}static createTubeRow(t){const e=[],s=this.createTube(.015,.05),r=new c.a(-.23,0,t);for(let n=0;n<5;n++)s.forEach(t=>{e.push(t.add(r))}),r.x+=.0425;r.x+=.1;for(let n=0;n<4;n++)s.forEach(t=>{e.push(t.add(r))}),r.x+=.0425;return e}static createMemoryUnit(){const t=[];for(let e=0;e<5;e++)this.createTubeRow(e*this.tubeDistance-.22).forEach(e=>{t.push(e)});for(let e=5;e<10;e++)this.createTubeRow(e*this.tubeDistance-.165).forEach(e=>{t.push(e)});return t}}return t.tubeDistance=.0425,t})();class k extends f.a{constructor(t,e,s,r,n){super(n),this.position=r;const a=f.a.withMesh(t,n);a.color=[.5,.5,.5,1],a.worldTransform=w.a.rotationX(Math.PI/2).multiply(w.a.translation(r));const h=f.a.withMesh(new o.a(i.a.createBox(new c.a(.25,.25,.1)),this.gl),n);h.color=[.5,.5,.5,1],h.worldTransform=w.a.translation(r.add(new c.a(0,0,-.15)));const d=f.a.withMesh(e,n);d.color=[.2,.2,.2,1],d.worldTransform=w.a.rotationX(Math.PI/2).multiply(w.a.translation(r)),this.children=[a,h,d],this.createRegisters(s,n)}createRegisters(t,e){this.registers=[];let s=this.position.add(new c.a(-.23,.22,0));for(let r=0;r<5;r++){const n=this.createIndicators(t,e);this.registers[r]=new m(n,s),s=s.add(new c.a(0,-y.tubeDistance,0))}s=s.add(new c.a(0,-.055,0));for(let r=5;r<10;r++){const n=this.createIndicators(t,e);this.registers[r]=new m(n,s),s=s.add(new c.a(0,-y.tubeDistance,0))}}createIndicators(t,e){const s=[];for(let r=0;r<9;r++){const n=f.a.withMesh(t,e);n.program=e.emitterShader,n.color=[1,.2,.2,1],s[r]=n}return s}draw(){this.children.forEach(t=>{t.draw()}),this.renderingContext.emitterShader.use(),this.registers.forEach(t=>{let e=t.position;for(let s=0;s<5;s++)this.drawIndicator(t,s,e),e=e.add(new c.a(.0425,0,0));e=e.add(new c.a(.1,0,0));for(let s=5;s<9;s++)this.drawIndicator(t,s,e),e=e.add(new c.a(.0425,0,0))}),this.renderingContext.standardShader.use()}drawIndicator(t,e,s){const r=t.indicators[e];let n=0;0!==e&&(1===e&&e--,t.value<0&&e++,n=Number(t.value.toFixed(7)[e])*(2*Math.PI/10)),r.worldTransform=w.a.rotationX(Math.PI/2).multiply(w.a.translation(new c.a(0,.0095,0))).multiply(w.a.rotationZ(n)).multiply(w.a.translation(s)),r.draw()}}class M extends h.a{constructor(t){super(t),this.processor=new b,this.loadExampleProgram2();const e=new o.a(i.a.createCase(new c.a(.25,.05,.25)),t.gl),s=new o.a(y.createMemoryUnit(),t.gl),r=new o.a(i.a.createBox(new c.a(.0025,.003,.0036)),t.gl),n=this.createMemoryUnitNode(e,s,r,new c.a(-.5,1,0)),a=this.createMemoryUnitNode(e,s,r,new c.a(-.5,.5,0)),h=this.createMemoryUnitNode(e,s,r,new c.a(-.5,0,0)),d=this.createMemoryUnitNode(e,s,r,new c.a(-.5,-.5,0)),l=this.createMemoryUnitNode(e,s,r,new c.a(-1,1,0)),u=this.createMemoryUnitNode(e,s,r,new c.a(-1,.5,0)),p=this.createMemoryUnitNode(e,s,r,new c.a(-1,0,0)),g=this.createMemoryUnitNode(e,s,r,new c.a(-1,-.5,0)),w=this.createMemoryUnitNode(e,s,r,new c.a(-1.5,1,0));this.memoryBanks=[n,a,h,d,l,u,p,g,w],this.nodes=this.memoryBanks,this.light.position=new c.a(.5,2,.5),this.camera.eye=new c.a(0,.5,3.3),this.camera.target=new c.a(0,.25,0),this.clearColor=[.1,.1,.1,1]}createMemoryUnitNode(t,e,s,r){return new k(t,e,s,r,this.renderingContext)}loadExampleProgram1(){this.processor.setTape(1,"[1]\n20900\n21000\n22000\n23000\n24000\n25000\n10110\n+10000000\n10120\n+01000000\n10130\n+15500000\n03202\n02102\n"),this.processor.setTape(2,"[2]\n11040\n51040\n07300\n11001\n07400\n10901\n12010\n13040\n31040\n01140\n24000\n20900\n05202\n05202\n00100\n")}loadExampleProgram2(){this.processor.setTape(1,"[1]\n20900\n21000\n22000\n23000\n24000\n25000\n10110\n+05000000\n10120\n+90000000\n10130\n+10000000\n10140\n+20000000\n11050\n03202\n02102\n"),this.processor.setTape(2,"[2]\n07400\n11001\n33020\n01220\n05303\n02203\n25009\n64050\n20900\n15010\n03202\n"),this.processor.setTape(3,"[3]\n00100\n")}draw(t){super.draw(t),this.processor.step(),this.copyState(),this.renderingContext.standardShader.use(),this.nodes.forEach(t=>{t.draw()})}copyState(){for(let t=0;t<9;t++){const e=this.memoryBanks[t];for(let s=0;s<10;s++){const r=e.registers[s],n=String(10*(t+1)+s);r.value=this.processor.peek(n)}}}}var C=s("4u2P"),v=s("fXoL"),N=s("jhN1"),E=s("S8xs");const x=[{path:"",component:(()=>{class t{constructor(t){this.isOrtographicProjection=!1,t.setTitle("Harwell Dekatron")}ngOnInit(){const t=this.appCanvas.surface.nativeElement.getContext("webgl");if(t){const e=new C.a(t);this.scene=new M(e),this.appCanvas.setScene(this.scene)}}onChangeOrtographicProjection(){this.isOrtographicProjection=!this.isOrtographicProjection,this.scene.camera.orthographic=this.isOrtographicProjection}}return t.\u0275fac=function(e){return new(e||t)(v.Gb(N.b))},t.\u0275cmp=v.Ab({type:t,selectors:[["harwell-component"]],viewQuery:function(t,e){var s;1&t&&v.Zb(a.a,!0),2&t&&v.Wb(s=v.Qb())&&(e.appCanvas=s.first)},decls:13,vars:2,consts:[["id","bodyContainer"],["id","leftPanel"],[3,"isAnimated"],["accordion-heading","","type","button",1,"btn","btn-link","btn-block","clearfix"],[1,"badge","badge-arrow","float-left"],[1,"float-left"],["value","ds","type","checkbox",3,"checked","change"]],template:function(t,e){1&t&&(v.Jb(0,"div",0),v.Jb(1,"div",1),v.Jb(2,"accordion",2),v.Jb(3,"accordion-group"),v.Jb(4,"button",3),v.Jb(5,"span",4),v.bc(6,"\u2b9e"),v.Ib(),v.Jb(7,"span",5),v.bc(8,"Settings"),v.Ib(),v.Ib(),v.Jb(9,"label"),v.Jb(10,"input",6),v.Pb("change",(function(){return e.onChangeOrtographicProjection()})),v.Ib(),v.bc(11," Orthographic projection "),v.Ib(),v.Ib(),v.Ib(),v.Ib(),v.Hb(12,"app-canvas"),v.Ib()),2&t&&(v.wb(2),v.Ub("isAnimated",!0),v.wb(8),v.Ub("checked",e.isOrtographicProjection))},directives:[E.a,E.c,a.a],styles:["#leftPanel[_ngcontent-%COMP%]{width:350px;height:768px;float:left;overflow-y:auto;white-space:normal}#bodyContainer[_ngcontent-%COMP%]{white-space:nowrap}.badge-arrow[_ngcontent-%COMP%]{margin-top:4px;transition-duration:.2s;transition-property:transform}.panel-open[_ngcontent-%COMP%]   .badge-arrow[_ngcontent-%COMP%]{transform:rotate(90deg)}ul[_ngcontent-%COMP%]{padding-left:25px}.gear-group-a[_ngcontent-%COMP%]{background-color:#99801a}.gear-group-l[_ngcontent-%COMP%]{background-color:#e6801a}.gear-group-n[_ngcontent-%COMP%]{background-color:#40bf4d}.gear-group-o[_ngcontent-%COMP%]{background-color:#fff}.gear-group-p[_ngcontent-%COMP%]{background-color:#80bf33}.gear-group-e[_ngcontent-%COMP%]{background-color:#7366b3}.gear-group-h[_ngcontent-%COMP%]{background-color:#a666b3}.gear-group-c[_ngcontent-%COMP%]{background-color:#80bfe6}.gear-group-k[_ngcontent-%COMP%]{background-color:#73ccbf}"]}),t})()}];let P=(()=>{class t{}return t.\u0275mod=v.Eb({type:t}),t.\u0275inj=v.Db({factory:function(e){return new(e||t)},imports:[[n.a.forChild(x)],n.a]}),t})();var T=s("YP2Z");let I=(()=>{class t{}return t.\u0275mod=v.Eb({type:t}),t.\u0275inj=v.Db({factory:function(e){return new(e||t)},imports:[[r.b,P,T.a,E.b.forRoot()]]}),t})()}}]);